(self.webpackChunkvk=self.webpackChunkvk||[]).push([[72709],{616202:(_,e,o)=>{"use strict";function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M6.25 1a.75.75 0 0 1 .75.75v.26L8.32 2H13v-.25a.75.75 0 0 1 1.5 0v.36c.43.06.82.17 1.18.35a4.25 4.25 0 0 1 1.86 1.86c.25.5.36 1.04.41 1.67.05.61.05 1.38.05 2.33v3.36c0 .96 0 1.72-.05 2.33a4.36 4.36 0 0 1-.41 1.67 4.25 4.25 0 0 1-1.86 1.86c-.5.25-1.04.36-1.67.41-.61.05-1.37.05-2.33.05H8.32c-.96 0-1.72 0-2.33-.05a4.36 4.36 0 0 1-1.67-.41 4.25 4.25 0 0 1-1.86-1.86A4.36 4.36 0 0 1 2.05 14C2 13.4 2 12.64 2 11.68V8.32c0-.96 0-1.72.05-2.33.05-.63.16-1.17.41-1.67a4.25 4.25 0 0 1 1.86-1.86c.36-.18.75-.29 1.18-.35v-.36A.75.75 0 0 1 6.25 1ZM5.5 3.63c-.2.04-.36.1-.5.17A2.75 2.75 0 0 0 3.8 5c-.13.25-.21.58-.25 1.11-.03.26-.04.54-.04.88h12.98c0-.34-.01-.62-.04-.88a2.91 2.91 0 0 0-.25-1.1A2.75 2.75 0 0 0 15 3.8c-.14-.07-.3-.13-.5-.17v.12a.75.75 0 0 1-1.5 0v-.24l-1.35-.01H7v.25a.75.75 0 0 1-1.5 0v-.12Zm11 4.86h-13v3.16c0 1 0 1.7.05 2.24.04.54.12.86.25 1.1A2.75 2.75 0 0 0 5 16.2c.25.13.58.21 1.11.25.55.05 1.25.05 2.24.05h3.3c1 0 1.7 0 2.24-.05.53-.04.86-.12 1.1-.25A2.75 2.75 0 0 0 16.2 15c.13-.25.21-.58.25-1.11.05-.55.05-1.25.05-2.24V8.49ZM15 13.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/></svg>',name:"calendar_outline_20"}}o.d(e,{getIcon20CalendarOutline:()=>i})},237016:(_,e,o)=>{"use strict";function i(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 4.22a.75.75 0 0 1 0 1.06L7.8 10l4.72 4.72a.75.75 0 1 1-1.06 1.06l-5.25-5.25a.75.75 0 0 1 0-1.06l5.25-5.25a.75.75 0 0 1 1.05 0z" fill="currentColor"/></svg>',name:"chevron_left_outline_20"}}o.d(e,{getIcon20ChevronLeftOutline:()=>i})},110779:(_,e,o)=>{"use strict";function i(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.47 4.22a.75.75 0 0 0 0 1.06L12.19 10l-4.72 4.72a.75.75 0 1 0 1.06 1.06l5.25-5.25a.75.75 0 0 0 0-1.06L8.53 4.22a.75.75 0 0 0-1.06 0z" fill="currentColor"/></svg>',name:"chevron_right_outline_20"}}o.d(e,{getIcon20ChevronRightOutline:()=>i})},931618:(_,e,o)=>{"use strict";o.d(e,{dateFormat:()=>C,monthFormat:()=>B,DateCalendar:()=>T,Timepicker:()=>I,Datepicker:()=>A,Daypicker:()=>R,getLangsForMonth:()=>W,getMonths:()=>K});o(226699),o(319601),o(241539),o(339714),o(804723),o(115306),o(923157),o(573210),o(454747);var i=o(873589),a=o(152278),d=o(70162),t=o(733164),l=o(342269),n=o(679740),s=o(631351),r=o(840060),E=o(927766),b=o(483295),u=o(110779),D=o(237016),p=o(616202),c=o(66433);function m(){return m=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(_[i]=o[i])}return _},m.apply(this,arguments)}var P={mn:[],mnOf:[],mnOfSm:[],days:["mon","tue","wed","thu","fri","sat","sun"]},v=(0,d.getLang)("larr");"larr"===v&&(v="&larr;");var O=(0,d.getLang)("rarr");"rarr"===O&&(O="&rarr;");for(var M=["d","w","m"],w=1;w<13;w++){var g=W(w);P.mn.push(g[0]),P.mnOf.push(g[1]),P.mnOfSm.push(g[2])}for(var h=0;h<7;h++){var U=void 0;switch(h){case 0:U=(0,d.getLang)("events_mon");break;case 1:U=(0,d.getLang)("events_tue");break;case 2:U=(0,d.getLang)("events_wed");break;case 3:U=(0,d.getLang)("events_thu");break;case 4:U=(0,d.getLang)("events_fri");break;case 5:U=(0,d.getLang)("events_sat");break;case 6:U=(0,d.getLang)("events_sun")}U&&!U.startsWith("events")&&(P.days[h]=U)}var L=[31,0,31,30,31,30,31,31,30,31,30,31];window.cals||(window.cals={list:{},getMonth:function(_,e,o,i){return window.cals.list[_]&&window.cals.list[_].getMonth(e,o,!1,i),!1},getDay:function(_,e,o,i){return window.cals.list[_]&&window.cals.list[_].getDay(e,o,i),!1}});var C=()=>{var _=(0,d.getLang)("datepicker_date_format");return"date format"===_&&(_="{day} {month} {year}"),_},B=()=>{var _=(0,d.getLang)("datepicker_month_format");return"month format"===_&&(_="{month} {year}"),_};class T{constructor(_){var e=_.container,o=Math.round(1e6*Math.random());if(e){var a=null,d=null;if(_.time&&_.inlineTime){var t=(0,i.ge)(_.time,e);a=t?(0,i.domPN)(t):(0,i.ge)(_.time),d=_.inlineTimeContainerIdx}else d=window._ui.reg(this);window.cals.list[d]=this,e.innerHTML="<div></div>",e=e.firstElementChild;var l=(M[_.mode]||_.mode||"d").toString().replace(/(this|next|prev)/,""),E=_.hideAnotherMonth&&!0,p=this.parseDay=function(_){return _=_.toString(),{y:parseInt(_.substr(0,4),10),m:parseInt(_.substr(4,2),10),d:parseInt(_.substr(6,2),10)}},c=_.day||{d:-1,m:-1,y:-1};c.m||(c=p(c));var m=_.addRows||"",v=_.addRowsM||m;this.setDay=(_,e,o)=>{c=e?{d:_,m:e,y:o}:p(_),this.getMonth(c.m,c.y)},this.setMode=_=>{l=(M[_]||_||"d").replace(/(this|next|prev)/,""),this.getMonth(c.m,c.y,!0)},this.getDay=_.getDay||function(_,e,o){},this.getMonth=function(t,p,O,M){var w=P.mn,g=new Date(p,t-1,1),h=new Date(p,t,0),U=new Date(p,t-1,0);g.od=g.getDay(),0==g.od&&(g.od=7);var C="-1"==l,T=!1,I=C?new Date(3e3,1,1):new Date;I=new Date(I.getFullYear(),I.getMonth(),"m"===l?1:I.getDate());var A=new Date,R=0;_.activePeriod&&(_.pastActive?(A=new Date(_.activePeriodStart-_.activePeriod),R=new Date(_.activePeriodStart)):(A=new Date(_.activePeriodStart),R=new Date(_.activePeriodStart+_.activePeriod)),A=new Date(A.getFullYear(),A.getMonth(),"m"===l?1:A.getDate()),R=new Date(R.getFullYear(),R.getMonth(),"m"===l?1:R.getDate())),L[1]=(0,n.isLeapYear)(g.getFullYear())?29:28;var W,K,y=[],f=[],k=[],V='<table class="%cls%" cols="%cols%" cellpadding="0" border="0" cellspacing="0">%rows%</table>';if("m"===l){var x=p==c.y?c.m:0,S=p+1,j=p-1,F=(0,u.getIcon20ChevronRightOutline)().icon,N=(0,D.getIcon20ChevronLeftOutline)().icon;W='<tr><td align="center" class="month">'+p+'</td><td class="month_arr"><a class="arr left" onclick="return cals.getMonth('+d+",1,"+j+');">'+N+'</a></td><td class="month_arr"><a class="arr right" onclick="return cals.getMonth('+d+",1,"+S+');">'+F+"</a></td></tr>",y.push('<tr><td colspan="2">'),y.push((0,i.rs)(V,{cls:"cal_table_head",cols:"3",rows:W})),y.push("</td></tr>"),f.push("<tr>");for(var H=1;H<=12;H++){var q="";H%2==1&&(H>1&&f.push("</tr><tr>"),q=" day_left");var $=H==x?"day sel":"day",z=new Date(p,H-1,1);(!_.pastActive&&z<I||_.pastActive&&z>I||_.pastActive&&z<_.startDate)&&($+=" inactive_day"),_.activePeriod&&(z>R||z<A)&&($+=" inactive_day"),z.getTime()===I.getTime()&&($+=" today"),f.push('<td class="'+$+q+'" id="day'+H+"_"+o+'" onclick="return cals.getDay('+d+", 1, "+H+", "+p+');">'+w[H-1]+"</td>")}f.push("</tr>"),k.push((0,i.rs)(V,{cls:"cal_table",cols:"2",rows:"<thead>"+y.join("")+'</thead><tbody class="month_selector">'+f.join("")+"</tbody>"})),O||(e.style.height=e.offsetHeight+"px"),(0,i.val)(e,k.join(""))}else{var G,Y,Q,X,J=!1,Z=p==c.y&&t==c.m?c.d:0;Z>0&&(J=!0),12==t?(G=1,Y=p+1):(G=t+1,Y=p),1==t?(Q=12,X=p-1):(Q=t-1,X=p),G==c.m&&(Z=c.d+h.getDate(),J=!0),Q==c.m&&(Z=c.d-U.getDate(),J=!0);var __=B().replace("{month}",w[t-1]).replace("{year}",'<span class="year">'+p+"</span>"),e_=(0,b.classNames)("cal_table",{disabled:C,unshown:M}),o_=(0,u.getIcon20ChevronRightOutline)().icon,i_=(0,D.getIcon20ChevronLeftOutline)().icon;W='<tr><td class="month"><a class="cal_month_sel" onclick="return cals.getMonth('+d+","+t+","+p+',1);">'+__+'</a></td><td class="month_arr"><a class="arr left" onclick="return cals.getMonth('+d+","+Q+","+X+');">'+i_+'</a></td><td class="month_arr"><a class="arr right" onclick="return cals.getMonth('+d+","+G+","+Y+');">'+o_+"</a></td></tr>",K='<tr><td class="month">'+__+'</td><td class="month_arr"><span class="arr left">'+i_+'</span></td><td class="month_arr"><span class="arr right">'+o_+"</span></td></tr>",y.push('<tr><td colspan="7">'),y.push((0,i.rs)(V,{cls:"cal_table_head",cols:"3",rows:C?K:W})),y.push("</td></tr><tr>");for(var a_=0;a_<7;a_++)y.push('<td class="daysofweek">'+P.days[a_]+"</td>");y.push("</tr>"),f.push("<tr>");for(var d_=[],t_=1;t_<=42;t_++){var l_=t_%7==1?" day_left":"",n_=t_-g.od>=0&&t_-g.od<L[t-1]?t_-g.od+1:0,s_=new Date(p,t-1,t_-g.od+1),r_=n_,E_=1;"w"===l&&(r_=t_-g.od-t_%7+2,t_%7==0&&(r_-=7),Z&&8==(E_=8-(Z+g.od-1)%7)&&(E_=1));var b_=void 0,u_=l_;if(u_+=Z>0&&n_>=Z&&n_<Z+E_?" day sel":" day",(!_.pastActive&&s_<I||_.pastActive&&s_>I)&&(u_+=" inactive_day"),_.activePeriod&&(s_>R||s_<A)&&(u_+=" inactive_day"),s_.getTime()==I.getTime()&&(u_+=" today"),n_>0)d_[t_]=r_,f.push('<td id="day'+n_+"_"+o+'" class="'+u_+'" onclick="return cals.getDay('+d+", "+r_+", "+t+", "+p+');">'+n_+"</td>");else if(36!=t_){if(!T)if("w"===l&&(d_[t_]=r_),E)b_="&nbsp",f.push('<td class="day no_month_day'+l_+'">'+b_+"</td>");else{d_[t_]=r_,b_=s_.getDate();var D_=t_<=7;D_?(u_+=" prev_month_day",u_+=J&&U.getDate()+Z===b_?" sel":""):(u_+=" next_month_day",u_+=J&&Z-h.getDate()===b_?" sel":"");var p_=D_?t-1:t+1,c_=p;p_<1&&(p_=12+p_,c_=p-1),p_>12&&(p_-=12,c_=p+1),f.push(`<td id="day${n_}_${o}" class="${u_}" onclick="return cals.getDay(${d}, ${b_}, ${p_}, ${c_});" >${b_}</td>`)}}else T=!0;t_%7==0&&t_<36&&f.push("</tr><tr>")}f.push("</tr>"+m),f=f.join("").replace("<tr></tr>",""),k.push((0,i.rs)(V,{cls:e_,cols:"7",rows:"<thead>"+y.join("")+"</thead><tbody>"+f+"</tbody>"})),y=[],f=[],I=new Date(I.getFullYear(),I.getMonth(),1),Z=p==c.y?c.m:0,e_="cal_table"+(C?" disabled":"")+(M?"":" unshown"),W='<tr><td class="month"><a class="cal_month_sel" onclick="return cals.getMonth('+d+","+t+","+p+');">'+p+'</a></td><td class="month_arr"><a class="arr left" onclick="return cals.getMonth('+d+","+t+","+(p-1)+',1);">'+i_+'</a></td><td class="month_arr"><a class="arr right" onclick="return cals.getMonth('+d+","+t+","+(p+1)+',1);">'+o_+"</a></td></tr>",K='<tr><td class="month">'+p+'</td><td class="month_arr"><span class="arr left">'+i_+'</span></td><td class="month_arr"><span class="arr right">'+o_+"</span></td></tr>",y.push('<tr><td colspan="2">'),y.push((0,i.rs)(V,{cls:"cal_table_head",cols:"3",rows:C?K:W})),y.push("</td></tr>"),f.push("<tr>");for(var m_=1;m_<=12;m_++){var P_="";m_%2==1&&(m_>1&&f.push("</tr><tr>"),P_=" day_left");var v_="day ",O_=new Date(p,m_-1,1);(!_.pastActive&&O_<I||_.pastActive&&O_>I)&&(v_+=" inactive_day"),_.activePeriod&&(O_.getMonth()>R.getMonth()||O_.getMonth()<A.getMonth())&&(v_+=" inactive_day"),O_.getTime()==I.getTime()&&(v_+=" today"),f.push('<td class="'+v_+P_+'" id="day'+m_+"_"+o+'" onclick="return cals.getMonth('+d+", "+m_+", "+p+');">'+w[m_-1]+"</td>")}f.push("</tr>"+v),k.push((0,i.rs)(V,{cls:e_,cols:"2",rows:"<thead>"+y.join("")+'</thead><tbody class="month_selector">'+f.join("")+"</tbody>"})),(0,i.val)(e,k.join("")),r.browser.opera&&!r.browser.mobile&&(0,s.animate)(e,{opacity:.99},20,s.animate.pbind(e,{opacity:1},20))}(_.onMonthSelect&&_.onMonthSelect(),_.time&&_.inlineTime)&&(0,i.ge)(_.inlineTimeContainerId).appendChild(a)},this.getMonth(c.m,c.y)}}}class I{constructor(_,e){if(void 0===e&&(e={}),_=(0,i.ge)(_)){var o=_.id,a=_.name||"",d=_.value||"",t=m({},{onUpdate:function(_,e){},time:0,hour:0,min:0,minStep:5,resfmt:"ts",format:'{hour}<div class="timepicker_dots"> : </div>{min}'},{},e),l=_.parentNode;d&&(t.time=d),t.time&&(t.hour=Math.floor(t.time/3600),t.min=Math.floor((t.time-3600*t.hour)/60));var s=t.hour||0,r=t.min||0,E=t.resfmt;r-=r%t.minStep;var b=t.format.replace("{hour}",`<div class="fl_l datepicker_item"><input type="hidden" id="${o}_hour_input" value="${s}"/></div>`).replace("{min}",`<div class="fl_l datepicker_item"><input type="hidden" id="${o}_min_input" value="${r}"/></div>`),u=(0,i.ce)("div",{id:o+"_timepicker_container",className:"timepicker_container",innerHTML:`\n      <input type="hidden" name="${a}" id="${o}" value="${d}"/>\n      ${b}\n      <div class="results_container">\n        <div class="result_list" style="display:none;"></div>\n        <div class="result_list_shadow">\n            <div class="shadow1"></div>\n            <div class="shadow2"></div>\n         </div>\n       </div>\n    `.trim()});l.replaceChild(u,_);for(var D=()=>{var _=this.hourDD.val(),e=this.minDD.val();"plain"===E?(0,i.ge)(o).value=_+":"+e:"ts"===E&&((0,i.ge)(o).value=3600*_+60*e),t.onUpdate(_,e)},p=[],c=[],P=0;P<24;P++)p.push([P,P]);for(var v=0;v<60;v+=t.minStep)c.push([v,(0,n.leadingZero)(v)]);this.hourDD=new window.Dropdown((0,i.ge)(o+"_hour_input"),p,{width:60,dark:1,multiselect:!1,onChange:D}),this.minDD=new window.Dropdown((0,i.ge)(o+"_min_input"),c,{width:60,dark:1,multiselect:!1,onChange:D})}}}class A{constructor(_,e){if(void 0===e&&(e={}),_=(0,i.ge)(_)){var o,d,n,s={},b=this,u=!1,D=0,c=0,v=_.id,O=v+"_date_input",M=_.name||v,w=_.parentNode,g=v+"_cal_box",h=v+"_cal_div",U=v+"_cal_frame",L=!1,A={mode:"d",resfmt:"ts",width:145,addRows:"",noFuture:!1,noPast:!1,activePeriod:!1,activePeriodStart:Date.now(),pastActive:!1,onUpdate:function(_,e){},onMonthSelect:function(){},hideAnotherMonth:!1,updateCalendarOnPastDateSet:!1},R=(e=m({},A,{},e)).mode,W=e.onUpdate,K=e.width,y=e.resfmt,f=e.addRows,k=e.addRowsM||f,V=_=>("h"===R||(u?this.hide():o(),(0,i.ge)(O).blur()),!1),x=function(){var _=(0,i.ge)(h),o=(0,i.ge)(g),a=(0,i.ge)(O),d=(0,i.getSize)("page_header_cont")[1],l=e.sideTopOffset;if(_&&o&&a){var n=(0,i.getSize)(_);(0,i.setStyle)(o,{marginTop:0});var s=(e.sideTop?n[1]+l<(0,i.getXY)(_)[1]-(0,E.scrollGetY)()-d-3*l:(0,i.getXY)(_)[1]+n[1]>(0,E.scrollGetY)()+window.lastWindowHeight)?-n[1]-30-2*(0,t.intval)((0,i.getStyle)(o,"paddingTop")):0;(0,i.setStyle)(o,{marginTop:s}),e.onMonthSelect()}};o=()=>{if(!u){u=!0,e.inlineTime||window._ui.sel(this.guid),(0,i.show)(g);var _=new T({container:(0,i.ge)(h),day:s,mode:R,addRows:f,addRowsM:k,hideAnotherMonth:e.hideAnotherMonth,pastActive:e.pastActive,activePeriod:e.activePeriod,activePeriodStart:e.activePeriodStart,time:e.time,inlineTime:e.inlineTime,inlineTimeContainerId:e.inlineTimeContainerId,onMonthSelect:x,getDay:function(o,i,a){var t={d:o,m:i,y:a};if(d(t,R),e.inlineTime){if(!e.updateCalendarOnPastDateSet&&new Date(t.y,t.m-1,t.d,23,59)<new Date)return;_.setDay(o,i,a)}}}),o=(0,i.getSize)((0,i.ge)(h));(0,i.setStyle)((0,i.ge)(U),{width:o[0],height:o[1]}),x(),(0,i.ge)(O).focus()}},d=function(_,o,a,d){if(!(!a&&e.noPast&&new Date(_.y,_.m-1,_.d,23,59)<new Date||!a&&e.noFuture&&new Date(_.y,_.m-1,_.d,0,0)>new Date)){if(!a&&e.activePeriod){var r,E,u=new Date(_.y,_.m-1,_.d,0,0);if(e.pastActive?(r=new Date(e.activePeriodStart-e.activePeriod),E=new Date(e.activePeriodStart)):(r=new Date(e.activePeriodStart),E=new Date(e.activePeriodStart+e.activePeriod)),r=new Date(r.getFullYear(),r.getMonth(),"m"===o?1:r.getDate()),u>(E=new Date(E.getFullYear(),E.getMonth(),"m"===o?1:E.getDate()))||u<r)return}s=_;var p=(0,i.geByClass1)("datepicker_control",n);if("h"===o)(0,i.addClass)(p,"disabled");else if((0,i.removeClass)(p,"disabled"),d){var m=(0,i.ge)(O);m&&(m.value="",e.placeholder&&(m.placeholder=e.placeholder))}else(0,i.ge)(O).value="m"===o?B().replace("{month}",(0,l.winToUtf)(P.mn[_.m-1])).replace("{year}",_.y):C().replace("{day}",_.d).replace("{month}",(0,l.winToUtf)(P.mnOf[_.m-1])).replace("{year}",_.y);e.inlineTime||b.hide(),d||("plain"===y?(0,i.ge)(v).value=_.d+"."+_.m+"."+_.y+(e.time?" "+D+":"+c:""):"ts"===y&&((0,i.ge)(v).value=Math.floor(new Date(_.y,_.m-1,_.d,D,c).getTime()/1e3)-(60*(new Date).getTimezoneOffset()+(0,t.intval)(vk.tz))-(0,t.intval)(vk.dt))),a||W(_,o)}},this.hide=function(_){u&&(u=!1,e.inlineTime&&!_||(window._ui.sel(!1),(0,i.hide)(g)))},this.setMode=function(_){d(s,R=_)},this.destroy=()=>{e.inlineTime||(window._ui._uids[this.guid]={}),(0,a.removeEvent)((0,i.geByClass1)("datepicker_control",n),"mousedown",V)},this.setDate=function(_,o,i,a,t,l){var n=!1;if(_||o||i)"m"!==R&&(s.d=i),s.m=o,s.y=_;else{var r=new Date;"m"!==R&&(s.d=r.getDate()),s.m=r.getMonth()+1,s.y=r.getFullYear(),n=!0}void 0!==t&&void 0!==l&&(D=t,c=l),d(s,R,a,n&&e.allowEmpty)},this.toogle=V,this.setActivePeriodStart=function(_){e.activePeriodStart=_};var S,j=0;if(e.day||e.month||e.year)"m"!==R&&(s.d=e.day),s.m=e.month,s.y=e.year,e.time&&(D=e.hour||0,c=e.min||0);else if(S=(_.value||"").match(/(\d+)\.(\d+)(?:\.(\d+))?(?:\s+(\d+)\:(\d+))?/))"m"!==R&&(s.d=(0,t.intval)(S[3].length?S[1]:0)),s.m=(0,t.intval)(S[3].length?S[2]:S[1]),s.y=(0,t.intval)(S[3].length?S[3]:S[2]),e.time&&(D=S[4]||0,c=S[5]||0);else if(parseInt(_.value)){var F=parseInt(_.value)+(60*(new Date).getTimezoneOffset()+(0,t.intval)(vk.tz))+(0,t.intval)(vk.dt);j=new Date(1e3*F)}else if(e.date){var N=(0,t.intval)(e.date)+(60*(new Date).getTimezoneOffset()+(0,t.intval)(vk.tz))+(0,t.intval)(vk.dt);j=new Date(1e3*N)}else j=new Date,L=!0;j&&(s.d=j.getDate(),s.m=j.getMonth()+1,s.y=j.getFullYear(),D=j.getHours(),c=j.getMinutes());var H=(0,p.getIcon20CalendarOutline)().icon;if(n=(0,i.ce)("div",{id:v+"_datepicker_container",className:"datepicker_container",innerHTML:`\n      <input type="hidden" name="${M}" id="${v}"/>\n      <div class="datepicker_control">\n        <input readonly="1" type="text" class="datepicker_text" id="${O}"/>\n        <span class="datepicker_control_icon">${H}</span>\n      </div>\n      <div id="${g}" class="cal_box">\n        <iframe id="${U}" class="cal_frame"></iframe>\n        <div id="${h}" class="cal_div"></div>\n      </div>\n    `.trim()},{width:K}),w.replaceChild(n,_),(0,a.addEvent)((0,i.geByClass1)("datepicker_control",n),"mousedown",V),d(s,R,!0,L&&e.allowEmpty),e.inlineTime||(this.guid=window._ui.reg({container:n,onEvent:_=>{if("mousedown"===_.type){for(var e=!0,o=_.target;o&&o!==o.parentNode;){if(o===n){e=!1;break}o=o.parentNode}e&&this.hide()}},_blur:()=>{this.hide()}})),e.time){var q=(0,i.ge)(e.time);this.timePicker=new I(q,{onUpdate:function(_,e){D=_,c=e,d(s,R)},resfmt:y,hour:D,min:c,minStep:e.minStep||5})}r.browser.mozilla&&(0,i.hide)(U)}}}class R{constructor(_,e){if(void 0===e&&(e={}),_=(0,i.ge)(_)){var o,a,t,l=_.id,n=_.name||"",s=_.value||"",r="padding:0 3px;width:4px;",E=m({},{onUpdate:function(_,e,o){},date:0,year:0,month:0,day:0,format:`{day}<div class="fl_l datepicker_item" style="${r}">&nbsp;</div>{month}<div class="fl_l datepicker_item" style="${r}">&nbsp;</div>{year}`,width:0},{},e),b=_.parentNode;if(s&&(E.date=s),E.date)if(E.date<3e7)E.year=Math.floor(E.date/1e4),E.month=Math.floor((E.date-1e4*E.year)/100),E.day=E.date-1e4*E.year-100*E.month;else{var u=new Date(1e3*E.date);E.year=u.getFullYear(),E.month=u.getMonth(),E.day=u.getDate()}var D=E.format.replace("{year}",`<div class="fl_l datepicker_item"><input type="hidden" id="${l}_year_input" value="${E.year}"/></div>`).replace("{month}",`<div class="fl_l datepicker_item"><input type="hidden" id="${l}_month_input" value="${E.month}"/></div>`).replace("{day}",`<div class="fl_l datepicker_item"><input type="hidden" id="${l}_day_input" value="${E.day}"/></div>`),p=`<div class="fl_l datepicker_item"><input type="hidden" name="${n}" id="${l}" value="${s}"/>${D}</div>`,c=(0,i.ce)("div",{id:l+"_daypicker_container",className:"daypicker_container clear_fix",innerHTML:p});b.replaceChild(c,_);for(var v=function(_,e){for(var o=new Date(e||2004,_,0).getDate(),i=[[0,(0,d.getLang)("global_day_label")]],a=1;a<=o;a++)i.push([a,a]);return i},O=function(){var _=parseInt(t.val()),e=parseInt(a.val()),d=parseInt(o.val());(0,i.ge)(l).value=1e4*_+100*e+d,o.setData(v(e,_)),E.onUpdate(_,e,d)},M=new Date,w=[[0,(0,d.getLang)("global_year_label")]],g=[[0,(0,d.getLang)("global_month_label")]],h=M.getFullYear();h>=(E.startYear||1800);h--)w.push([h,h]);for(var U=0;U<12;U++)g.push([U+1,P.mnOf[U]]);if(o=new window.Dropdown((0,i.ge)(l+"_day_input"),v(E.month,E.year),{width:80,dark:1,zeroPlaceholder:E.zeroPlaceholder,onChange:O}),a=new window.Dropdown((0,i.ge)(l+"_month_input"),g,{width:120,dark:1,zeroPlaceholder:E.zeroPlaceholder,onChange:O}),t=new window.Dropdown((0,i.ge)(l+"_year_input"),w,{width:75,dark:1,zeroPlaceholder:E.zeroPlaceholder,onChange:O}),E.width){var L=(0,i.getSize)(c.firstElementChild)[0],C=E.width-L,B=(0,i.getSize)(a.container)[0];[a.container,a.resultList].forEach((_=>{(0,i.setStyle)(_,{width:parseInt(B+C)})}))}}}}function W(_){switch(_){case 1:return[(0,d.getLang)("Month1"),(0,d.getLang)("Month1_of"),(0,d.getLang)("month1_of")];case 2:return[(0,d.getLang)("Month2"),(0,d.getLang)("Month2_of"),(0,d.getLang)("month2_of")];case 3:return[(0,d.getLang)("Month3"),(0,d.getLang)("Month3_of"),(0,d.getLang)("month3_of")];case 4:return[(0,d.getLang)("Month4"),(0,d.getLang)("Month4_of"),(0,d.getLang)("month4_of")];case 5:return[(0,d.getLang)("Month5"),(0,d.getLang)("Month5_of"),(0,d.getLang)("month5_of")];case 6:return[(0,d.getLang)("Month6"),(0,d.getLang)("Month6_of"),(0,d.getLang)("month6_of")];case 7:return[(0,d.getLang)("Month7"),(0,d.getLang)("Month7_of"),(0,d.getLang)("month7_of")];case 8:return[(0,d.getLang)("Month8"),(0,d.getLang)("Month8_of"),(0,d.getLang)("month8_of")];case 9:return[(0,d.getLang)("Month9"),(0,d.getLang)("Month9_of"),(0,d.getLang)("month9_of")];case 10:return[(0,d.getLang)("Month10"),(0,d.getLang)("Month10_of"),(0,d.getLang)("month10_of")];case 11:return[(0,d.getLang)("Month11"),(0,d.getLang)("Month11_of"),(0,d.getLang)("month11_of")];case 12:return[(0,d.getLang)("Month12"),(0,d.getLang)("Month12_of"),(0,d.getLang)("month12_of")]}}function K(_){var e=[0,1,2];e.includes(_)||((0,c.logError)(new Error(`getMonths should have format in ${e.join(",")}`)),_=0);for(var o=["null"],i=1;i<=12;i++)o.push(W(i)[_]);return o}},256152:(_,e,o)=>{"use strict";o.d(e,{default:()=>c,getUploadVideoExtMasks:()=>m,getUploadModule:()=>v,onVideoUploaded:()=>O});o(682772),o(747042),o(319601),o(115306);var i=o(146143),a=o(840060),d=o(733164),t=o(70162),l=o(226323),n=o(798262),s=o(520820),r=o(342269),E=o(501389),b=o(152278),u=o(927766),D=o(873589),p=o(285164);const c={getUploadModule:(_,e,o,i,a)=>v(_,e,o,i,a),initModalVideoUploader(_){var e=cur.videoUploadParams,o=(0,D.ge)("choose_video_upload");if(!o)return!1;this.initDragEvents();var i={};switch(_){case"article":i.onUploadProgress=()=>{},i.onUploadStartDone=()=>{null==window.cur.onMediaUploadStarted||window.cur.onMediaUploadStarted()},i.onUploadError=()=>{null==window.cur.onMediaUploadFail||window.cur.onMediaUploadFail()};break;case"market":i.onUploadStart=_=>{var e=_.file;null==window.cur.onMediaUploadStarted||window.cur.onMediaUploadStarted(e)}}return v(o,boxLayerWrap,e,null,i)},initDragEvents(){var _,e=_=>{cur.dragTimeout&&(clearTimeout(cur.dragTimeout),delete cur.dragTimeout);var e=(0,D.ge)("video_choose_upload_area_wrap");if(!(0,D.hasClass)(e,"video_choose_upload_area_enter")){(0,D.addClass)(e,"video_choose_upload_area_enter");var o=(0,D.ge)("video_choose_wrap"),i=(0,D.getXY)(o)[1],a=(0,D.getSize)(e)[1];return(0,D.hide)("video_choose_wrap"),(0,D.setStyle)(e,"height",(0,u.scrollGetY)()+(0,D.clientHeight)()-i+a),(0,b.cancelEvent)(_)}},o=_=>(window.cur.dragTimeout&&(clearTimeout(window.cur.dragTimeout),delete window.cur.dragTimeout),window.cur.dragTimeout=setTimeout((()=>{var _=document.getElementById("video_choose_upload_area_wrap");_&&(_.classList.remove("video_choose_upload_area_enter"),_.style.height="auto",(0,D.show)("video_choose_wrap"))}),100),(0,b.cancelEvent)(_)),i=_=>{if(o(),_.dataTransfer.files.length&&Upload.checkFilesSizes(window.videoInlineUploader,_.dataTransfer.files))return window.Upload&&Upload.checked&&Upload.checked[window.videoInlineUploader]&&Upload.onFileApiSend(window.videoInlineUploader,_.dataTransfer.files),(0,b.cancelEvent)(_)},a=()=>{(0,b.addEvent)(boxLayerWrap,"dragenter dragover",e),(0,b.addEvent)(boxLayerWrap,"dragleave",o),(0,b.addEvent)(boxLayerWrap,"drop",i)};a();var d=null==(_=(0,E.curBox)().getOptions())?void 0:_.onHide;setTimeout((0,E.curBox)().setOptions.pbind({onHide:()=>{if((0,b.removeEvent)(boxLayerWrap,"dragenter dragover",e),(0,b.removeEvent)(boxLayerWrap,"dragleave",o),(0,b.removeEvent)(boxLayerWrap,"drop",i),"function"==typeof d)return d()},onShow:()=>{Video.initChooseBox(),a()}}),0)}};function m(_){var e=p.VIDEO_UPLOAD_EXTS.slice(0,p.VIDEO_UPLOAD_EXTS.length);if("types"===_){for(var o=e.length,i=0;i<o;++i)e.push(e[i].toUpperCase());return"*."+e.join(";*.")}return"accept"===_?"."+p.VIDEO_UPLOAD_EXTS.join(",."):""}function P(_){if(!cur.leaving){var e=(0,t.getLang)("video_upload_changed"),o=!1;if((0,r.each)(window.cur.videoUploaders,((_,e)=>{Upload.isSomethingUploading(e)&&(o=!0)})),1===_){if(!o)return!0;var a=(0,i.showFastBox)({title:(0,t.getLang)("global_warning")},e,(0,t.getLang)("global_continue"),(function(){cur.leaving=!0,a.hide(),cur.onContinueCb&&cur.onContinueCb()}),(0,t.getLang)("global_cancel"),(function(){a.hide(),nav.objLoc.section="upload",nav.setLoc(nav.objLoc)}));return!1}return o?(0,d.winToUtf)(e.replace(/<\/?b>/g,"").replace(/<br\s*\/?>/g,"\n")):void 0}}function v(_,e,o,d,E){if(o){d=d||cur,(E=E||{}).onUploadStart||(E.onUploadStart=_=>{var e;boxQueue.hideLast(),cur.nav.push((function(_,e,o){if(!1===P(1))return cur.onContinueCb=nav.go.pbind(o),!1})),cur.prevBefUnload=window.onbeforeunload,window.onbeforeunload=P,E.onUploadProgress(_,0,0),null==(e=window.Wall)||null==e.showEditPost||e.showEditPost(),E.onUploadStartDone&&E.onUploadStartDone()}),E.onUploadComplete||(E.onUploadComplete=(_,e)=>{var o=(0,s.parseJSON)(e);o.video_id?O(_,o,d):"string"==typeof e&&e.indexOf("TERMINATED")>-1||Upload.onUploadError(_);E.onUploadCompleteDone&&E.onUploadCompleteDone(),setTimeout((()=>{E.onUploadAllCompleteDone&&!window.Upload.isSomethingUploading(_.ind)&&E.onUploadAllCompleteDone()}))}),E.onUploadProgress||(E.onUploadProgress=(_,e,o)=>{var i=void 0!==_.ind?_.ind:_;(0,D.show)("_im_media_preview"),d.showMediaProgress&&d.showMediaProgress("video",i,function(_,e,o){return{loaded:e,total:o,fileName:_.fileName?_.fileName.replace(/[&<>"']/g,""):void 0}}(_,e,o))}),E.onUploadError||(E.onUploadError=(_,e)=>{(0,n.statlogsValueEvent)("upload_video_fails",1,o.options.server,e),function(_){var e=void 0!==_.ind?_.ind:_,o=_.fileName?e+"_"+_.fileName:_;if((0,D.re)("upload"+o+"_progress_wrap"),!(0,D.geByClass1)("popup_box_container")){var a=(0,t.getLang)("video_upload_error");setTimeout((0,i.showFastBox)({title:(0,t.getLang)("global_error")},a).hide,2e3)}(0,l.topError)("Upload failed",{dt:-1,type:102,url:((0,D.ge)("file_uploader_form"+e)||{}).action}),Upload.embed(e)}(_)}),cur.maxFiles=(cur.chooseParams||{}).maxFiles||10;var b=cur.maxFiles-(cur.savedVideos||[]).length,u=a.browser.safari?"":"video/*,"+m("accept");o.lang&&(cur.lang=(0,r.extend)(cur.lang||{},o.lang));var c={accept:u,file_input:null,file_name:"video_file",file_size_limit:1024*(o.options.file_size_limit_in_GB||p.VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB)*1024*1024,file_types_description:"Video files",file_types:m("types"),chooseBox:1,chunked:1,chunkSize:p.VIDEO_UPLOAD_CHUNK_SIZE,clear:1,dragEl:e===boxLayerWrap?boxLayerWrap:document.body,dropbox:e,from:o.vars.from,lang:o.lang,max_attempts:3,max_files:b,multiple:1,multi_progress:1,requestOptionsForFile:!0,type:"video",visibleDropbox:!o.options.hasOwnProperty("visible_dropbox")||o.options.visible_dropbox},v=Upload.init(_,"",{},Object.assign(c,E));return window.cur.videoUploaders||(window.cur.videoUploaders=[]),window.cur.videoUploaders.push(v),v}}function O(_,e,o,a){o=o||cur;var d=void 0!==_.ind?_.ind:_,l=(_.fileName||_.filename||"").replace(/[&<>"']/g,""),n=l?d+"_"+l:_,s=e.owner_id+"_"+e.video_id,E=cur.isSnippetVideoSelection&&cur.chooseSnippetVideo,b=(0,D.ge)("upload"+n+"_progress_wrap");b&&(0,D.hide)((0,D.geByClass1)("progress_x",b)),ajax.post("al_video.php?act=a_videos_attach_info",{videos:s},{onDone:_=>{E||o.chooseMedia("video",s,(0,r.extend)(_[s],{upload_ind:n,upload_new:!0}));var d=e.owner_id,l=e.video_id,b=e.video_hash,u=0,p=()=>{ajax.post("al_video.php?act=encode_progress",{owner_id:d,vid:l,hash:b,need_thumb:1},{onDone:e=>{var b,u=!0;if(e){if(e.error)return b=(0,t.getLang)("video_upload_encode_error"),void setTimeout((0,i.showFastBox)({title:(0,t.getLang)("global_error")},b).hide,2e3);e.thumb&&100===parseInt(e.percents,10)&&(u=!1,ajax.post("al_video.php",{act:"a_video_photo_sizes",oid:d,vid:l},{onDone:e=>{if(cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return cur.chooseSnippetVideo(s,e),void(0,D.re)("upload"+n+"_progress_wrap");o.hasChosenMedia("video",s)?o.updateChosenMedia("video",s,(0,r.extend)(e,{upload_ind:n,upload_new:!0})):a&&a(_,s)}}))}u&&(E||o.hasChosenMedia("video",s))&&setTimeout(p,1e3)},onFail:()=>{++u<3&&setTimeout(p,2e3*u)}})};p()}})}},840103:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{VideoUpload:()=>VideoUpload});var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(382526),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(141817),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(892222),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(682772),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(821249),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(747042),core_js_modules_es_object_assign__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(319601),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(241539),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(339714),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(115306),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(323123),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(573210),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(454747),_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(873589),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(840060),_web_lib_nav_utils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(101178),_web_lib_video__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(343474),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(769488),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(226323),_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(733164),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(822560),_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(631351),_web_lib_date__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(679740),_shared_lib_parse__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(520820),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(549357),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(501389),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(152278),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(342269),_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(897449),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(146143),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(555030),_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(285164),_videoplayer_lib_clipboard__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(15944),_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(368752),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(70162),_web_index__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(545161),_web_lib_utils__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(67328),_icons_desktop__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(484239),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(124041),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(506770),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(798262),_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(997109),_web_datepicker_datepicker__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(931618),_shared_ranges__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(844142),HOUR_IN_S=3600,HOUR_IN_MS=1e3*HOUR_IN_S,DAY_IN_MS=24*HOUR_IN_MS,MONTH_IN_MS=30*DAY_IN_MS,DEFAULT_TIMER_GAP=4*HOUR_IN_MS,DEFAULT_THUMB_ID="0_0",CSS_CLASS_ERROR_MESSAGE="VideoUploadItem__postpone_error_message-show",VideoUpload={FILE_TYPES:"",UPLOAD_ACCEPT:"",uploadNum:0,showBox:function(_){return void 0===_&&(_={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(_.oid)||(_.oid=cur.oid||vk.id),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(_.oid)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("video_upload_box_placeholder"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_block")||4!=vk.al?(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(_,{ocl:cur.ocl?1:0}),cur.uploadVideoBox=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showBox)("al_video.php?act=upload_box",_,{stat:["video_edit.css","privacy.css",window.jsc("web/privacy.js")],params:{containerClass:"video_upload_box",onHide:window.VideoUpload.onHideUploadPanel,onDestroy:window.VideoUpload.onDestroyUploadBox,onShow:window.VideoUpload.onShowUploadPanel,width:450},onDone:()=>{cur.uploadVideoBox.removeButtons(),cur.uploadVideoBoxContainer=cur.uploadVideoBox.bodyNode.closest(".popup_box_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(cur.uploadVideoBox.bodyNode)),cur.uploadVideoBox.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),cur.chosenOwnerId=cur.oid,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.inArray)(_.from,["article","board","post","comment","message"])&&window.VideoUpload.toExternalAdd(_.from)}}),!1):nav.go("videos"+cur.oid+"?z=upload_video")):((0,_web_index__WEBPACK_IMPORTED_MODULE_34__.showQuickLoginBox)(),!1)},buildExtMasks:function(_){var e=_?_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__.SHORT_VIDEO_UPLOAD_EXTS:_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__.VIDEO_UPLOAD_EXTS;window.VideoUpload.UPLOAD_ACCEPT="."+e.join(",.");for(var o=e.length,i=0;i<o;++i)e.push(e[i].toUpperCase());window.VideoUpload.FILE_TYPES="*."+e.join(";*.")},onHideUploadPanel:function(){},onDestroyUploadBox:function(){delete window.cur.uploadVideoBox},onShowUploadPanel:function(){},checkResize:function(){},resizeWebStreamingElements:function(){var _,e=window.VideoUpload._liveCategoryDropdown,o=window.VideoUpload._gameCategoryDropdown,i=null==(_=document.querySelector(".VideoWebcastForm__main"))?void 0:_.clientWidth;i&&(e&&e.setOptions({width:i}),o&&o.setOptions({width:i}))},resizeElements:function(){var _=window.VideoUpload._uploadAlbumChooser;if(_){var e,o=null==(e=document.querySelector(".VideoUploadItem__main"))?void 0:e.clientWidth;if(!o)return;for(var i in _)if(_.hasOwnProperty(i)){_[i].setOptions({width:o});var a=window.VideoUploadSubtitles[i];if(a){var d=a.elems.tracksLangDropdown;for(var t in d)d.hasOwnProperty(t)&&d[t].setOptions({width:o/2});a.elems.defaultLangDropdown.setOptions({width:o/2})}}}},destroyTab:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_block");if(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload",_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(e,(_=>{var o=e[_];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cleanElems)(o)})),cur.resizeWebStreamingElementsHandler&&(cur.resizeWebStreamingElementsHandler=!1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.removeEvent)(window,"resize",window.VideoUpload.resizeWebStreamingElements)),cur.resizeElementsHandler&&(cur.resizeElementsHandler=!1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.removeEvent)(window,"resize",window.VideoUpload.resizeElements)),Video.uploadNum=0}},doResize:function(){},onPrivacyChangedStats:function(_,e){void 0===e&&(e="clips_uploader");var o="";switch(_){case"0":o="all";break;case"1":o="friends";break;case"2":o="friends_of_friends";break;case"3":o="only_me";break;case"4":o="some_friends";break;case"5":o="some_friends_list";break;case"-1":o="advanced_settings"}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)(e,1,"privacy",o)},onPrivacyChanged:function(_){var e=cur.tag2ElMap[_.substr(5)],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_publish",e);Privacy.getValue(_)>0?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(o,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(o,"disabled")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(o,"disabled")},onThumbClick(_,e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"video"),a={autoplay:1,module:"upload",onLoaded:()=>{var _=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_edit_repeat",o));Videoview.getPlayerObject().toggleLoop(_)}};return(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_16__.showInlineVideo)(i,"",a,e,_),!1},onRepeatChanged(_){VideoUpload.updatePlayer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_))},initUpload:function initUpload(uploadOptions,subtitleUploadOptions,itemTemplate,isShort){uploadOptions=uploadOptions.replace(/[\r\n]+/g,""),uploadOptions=JSON.parse(uploadOptions),cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.lang||{},uploadOptions.lang);var hashs={},tag=uploadOptions.vars.tag,ownerId=uploadOptions.vars.oid,options=uploadOptions.options,isUvUpload=options.isUvUpload;hashs[tag]=options.update_db_hash,cur.videoHashs=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.videoHashs||{},hashs);var boxTab=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_box_tab");if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_dropbox")&&boxTab){var p=boxTab.parentNode.parentNode.parentNode,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(`<div id="video_dropbox" class="dropbox choose">\n          <div class="dropbox_wrap">\n            <div class="dropbox_area">\n              <div class="dropbox_label">${uploadOptions.lang.drop_files_here}</div>\n            </div>\n          </div>\n        </div>`);p.appendChild(d)}window.VideoUpload.onShowUploadPanel();var placeholder=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_box_placeholder");if(placeholder){var uploadItem=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)('<div id="video_upload_box'+tag+'" class="noselect"></div>');placeholder.innerHTML="",placeholder.appendChild(uploadItem)}var initButton=function initButton(){var uploadErrorInfo=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_fail_info");uploadErrorInfo&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(uploadErrorInfo),Upload.init("video_upload_box"+tag,options.url,uploadOptions.vars,{file_name:"video_file",file_size_limit:1024*(options.file_size_limit_in_GB||_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__.VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB)*1024*1024,clips_size_max_limit:1024*_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__.CLIP_UPLOAD_MAX_FILE_SIZE_IN_GB*1024*1024,clips_duration_min_limit:3,clips_duration_max_limit:options.clips_duration_limit,file_types_description:"Video files",file_types:window.VideoUpload.FILE_TYPES,lang:uploadOptions.lang,flat_button:1,filesize_hide_last:1,chunked:1,multiple:!isShort,multi_progress:1,chunkSize:_shared_video_upload_constants__WEBPACK_IMPORTED_MODULE_31__.VIDEO_UPLOAD_CHUNK_SIZE,isUvUpload,isShort,useNewUploader:options.useNewUploader,extraUploadOptions:JSON.stringify(uploadOptions.extraUploadOptions),onUploadStart:function(_,e){uploadOptions.onUploadStart&&cur[uploadOptions.onUploadStart]();var o=void 0!==_.ind?_.ind:_,i=VideoUpload.getUniqueUploadItemId(o,_.fileName);cur._uploadStart=Date.now(),VideoUpload.uploadNum++,delete window.VideoUpload.videoUploadCallback;var a=function(){uploadOptions.vars.save_hashes||isShort||(nav.objLoc.section="upload",nav.setLoc(nav.objLoc));var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(itemTemplate,{id:i}));window.VideoUpload.initBeforeUnload(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_empty_placeholder_short");var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_block");o&&cur.newVideoUploadBlock&&(o.innerHTML="",o.insertAdjacentHTML("beforeend",cur.newVideoUploadBlock),cur.newVideoUploadBlock="");var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload",o));if(a){var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page_block_h2",a).cloneNode(!0),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_header_inner",d),l=a.cloneNode(!0);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(l,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t,`${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_adding_video_title")} ${VideoUpload.uploadNum}`),l.appendChild(d),l.appendChild(e),o.appendChild(l),window.scrollTo(0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(l)[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(t)[1])}else{VideoUpload.uploadNum=1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page_block",o).appendChild(e)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("video_upload_no_video"),uploadOptions.vars.save_hashes&&cur.oid>0&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_edit_repeat"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_publish")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload__tabs").innerHTML=`<div class="video_ocl_warn">${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_ocl_privacy")}</div>`),ownerId>0&&(cur.privacy["video"+i]||(cur.privacy["video"+i]=cur.privacy.video,cur.privacy["videocomm"+i]=cur.privacy.video),Privacy.update("video"+i),Privacy.update("videocomm"+i),options.playlist_privacy&&options.playlist_privacy[0]>0&&Privacy.setValue("video"+i,options.playlist_privacy),cur.tag2ElMap=cur.tag2ElMap||{},cur.tag2ElMap[i]=e,cur.onPrivacyChanged=window.VideoUpload.onPrivacyChanged),VideoUpload.initPrivacyControls(ownerId,cur.privacy,i),VideoUpload.initActionLink(),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().hide(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_main_block"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_search_input_wrapper"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e);var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+i);if(_.fileName){var s,r=_.fileName,E=window.VideoUpload.FILE_TYPES.split(";");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(E,(function(_,e){if((s=r.indexOf(e.substr(1)))==r.length-e.length+1)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"extension",e.substr(2)),r=r.substr(0,s),!1}));var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",n);b&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(b,r),b.select());var u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload_file_name",n);u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(u,r)}if(window.VideoUpload.videoUploadCallback&&(window.VideoUpload.videoUploadCallback(),delete window.VideoUpload.videoUploadCallback),cur.videoThumbUploadOpts&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.isObject)(cur.videoThumbUploadOpts)&&!isShort&&window.VideoUpload.initThumbUpload(cur.videoThumbUploadOpts,e),window.VideoUpload._uploadAlbumChooser=window.VideoUpload._uploadAlbumChooser||{},cur.videoPlaylists&&cur.videoPlaylists.length&&!isShort){var D,p=0,c=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_choose_playlist_placeholder");window.VideoUpload._uploadAlbumChooser[i]=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload_album_chooser_input",e),[[p,c]].concat(cur.videoPlaylists),{autocomplete:!0,big:!0,width:null==(D=document.querySelector(".VideoUploadItem__main"))?void 0:D.clientWidth,selectedItems:[options.aid||p],onChange:_=>{""===_&&window.VideoUpload._uploadAlbumChooser[i].val(p)}}),cur.resizeElementsHandler||(cur.resizeElementsHandler=!0,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.addEvent)(window,"resize",window.VideoUpload.resizeElements))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video-upload-album-chooser",e));var m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page_block_header",a),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("flat_button",m);P&&(P.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_another_one"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(P,"secondary")),isShort&&(cur.videoUploadAddMedia=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_add_media"),"media_preview",[["audio",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_clip_add_music")]],{editable:1,from:"video",limit:1,tooltip:!1,promotedAudios:options.promoted_audios,audioSectionId:options.audio_section_id}),cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.lang||{},{dont_attach:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_clip_dont_attach")}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ms_item_audio").setAttribute("data-title",""),VideoUpload.initPostponePicker()),uploadOptions.vars.save_hashes||isShort||(window.VideoUploadSubtitles||(window.VideoUploadSubtitles={}),window.VideoUploadSubtitles[i]={elems:{blockEl:n},options:subtitleUploadOptions,ownerId},window.VideoUploadSubtitles.init(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload__tabs",n)&&window.VideoUpload.showTab(n)),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_24__.autosizeSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",n),{minHeight:80,maxHeight:600})};if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_block"))a();else{var d,t=cur.privacy,l=cur.videoHashs,n=cur.videoThumbUploadOpts,s=cur.videoUploadThumbBtnTpl,r=cur.videoPlaylists,E=Object.assign({},window.Upload.options),b=Object.assign({},window.Upload.vars),u=cur.chosenOwnerId;null==(d=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)())||d.hide();var D=options.owner_videos_page||"videos"+ownerId,p={ocl:cur.ocl?1:0};isShort?(D="clips/upload"+ownerId,p={}):ownerId<0&&(D=options.owner_videos_page,p={}),nav.go(D,!1,{nocur:!0,params:p,onDone:function(){window.Upload.options=E,window.Upload.vars=b,window.Upload.vars[i]=uploadOptions.vars,window.Upload.options[i]&&(window.Upload.options[i]={}),setTimeout((()=>{cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.lang||{},uploadOptions.lang),cur.privacy=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.privacy||{},t),cur.videoHashs=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.videoHashs||{},l),cur.videoThumbUploadOpts=n,cur.videoUploadThumbBtnTpl=s,cur.videoPlaylists=r,cur.chosenOwnerId=u,a()}))}})}VideoUpload.checkNeedShowStickyPanel()},onUploadedVideoIdReceived:function(_,e){var o=VideoUpload.getUniqueUploadItemId(_.ind,_.fileName);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+o),"video_id",e)},onUploadComplete:function onUploadComplete(i,res){var obj;if(res){try{obj=eval("("+res+")")}catch(_){obj=(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_30__.fromQueryString)(res)}if(obj.code||obj.error)Upload.onUploadError(i,obj);else{uploadOptions.onUploadComplete&&cur[uploadOptions.onUploadComplete](obj);var videoId=obj.video_id,viewHash=obj.video_hash,uploadItemId=VideoUpload.getUniqueUploadItemId(i.ind||i,i.fileName),item=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+uploadItemId),callback=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+uploadItemId);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"video_id",videoId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"uploaded",1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"owner_id",ownerId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"view_hash",viewHash),isShort&&ajax.post("al_video.php?act=get_edit_hash",{video_id:videoId,owner_id:ownerId,hash:viewHash},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"edit_hash",e)}}),window.VideoUploadSubtitles[uploadItemId]&&window.VideoUploadSubtitles.onVideoUploaded(uploadItemId,videoId),window.VideoUpload.updateVideoLink(uploadItemId);var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload_link",_);if(e){var o,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"href-tpl"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i,{video_id:videoId});if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,a),e.removeAttribute("placeholder"),e.classList.contains("VideoUploadItem__videoLinkUrl"))e.href=a,null==(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoUploadItem__videoLink",_))||o.classList.add("VideoUploadItem__videoLink--ready");var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-subtitles-upload-item",_);d.length&&d.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"selected")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"uploaded")&&window.VideoUploadSubtitles.startUpload(_,cur.oid,videoId)}));var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__copy_video_link",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(t),t.onclick=()=>{(0,_videoplayer_lib_clipboard__WEBPACK_IMPORTED_MODULE_32__.copyToClipboard)(a),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.showDoneBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_link_copied"),{out:1500}),e.focus()};var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_ready_name",_);if(l){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{innerHTML:l.innerHTML,className:l.className,href:a.href});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(l).insertBefore(n,l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(l)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"saved")&&window.VideoUpload.saveParams((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__ready_button",_),!0),window.VideoUpload.setProgressValue(100,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_waiting"),_);var s=_.querySelector(".VideoUploadItem__thumbStubText");s&&(s.textContent=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_encoding")),window.VideoUpload.runVideoProgressUpdate(uploadItemId,ownerId,videoId,viewHash,1,-1,0,0,isShort)};item?callback():window.VideoUpload.videoUploadCallback=callback}}},onUploadProgress:function(_,e,o){var i=void 0!==_.ind?_.ind:_,a=VideoUpload.getUniqueUploadItemId(i,_.fileName),d=Math.min(e/o*100,100),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(d);uploadOptions.onUploadProgress&&cur[uploadOptions.onUploadProgress](t);var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+a);if(l){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(l,"progress")>t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(l,"max_size_error",!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(l,"progress",t);var n=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_uploaded_percent").replace("{percent}",t);window.VideoUpload.setProgressValue(d,n,l)}},onUploadError:function onUploadError(i,err){var debug;if(uploadOptions.onUploadError&&cur[uploadOptions.onUploadError](err),err&&(err.code||err.error)){try{debug=eval("("+err.debug+")")}catch(_){debug=(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_30__.fromQueryString)(debug)}err=err.code||err.error}else debug=!1;var logErrorData={oid:ownerId,mid:uploadOptions.vars.mid,tag,srv:options.server,extra:err};window.VideoUpload._logUploadStatus("fail",logErrorData),cur.videoLastError=!0;var index=void 0!==i.ind?i.ind:i,uploadItemId=i.uploadItemId||VideoUpload.getUniqueUploadItemId(index,i.fileName),item=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+uploadItemId),callback=function(){var _,e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+uploadItemId);e&&(-3==err?_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_error_file"):-4==err?_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_error_audio").replace("{link}",'<a href="/audio">').replace("{/link}","</a>"):-5==err?(_=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_claimed_not_uploaded"),debug&&debug.claim_id&&(_+=" ["+debug.claim_id+"]")):_=-12==err?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_flood_control"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_error_common"),window.VideoUpload.showError(e,_))};item?callback():window.VideoUpload.videoUploadCallback=callback,(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)(err)},onConnectionLost:function(_){uploadOptions.onConnectionLost&&cur[uploadOptions.onConnectionLost]();var e=void 0!==_.ind?_.ind:_,o=VideoUpload.getUniqueUploadItemId(e,_.fileName),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+o);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(i,"upload_index",o),window.VideoUpload.showError(i,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_connection_lost"),!0)},onDragEnter:()=>{},onDragOut:()=>{},onDrop:()=>{},clear:1,type:"video",max_attempts:3,server:options.server,error:options.error,error_hash:options.error_hash,dropbox:"video_dropbox",custom_hash:options.custom_hash,check_hash:options.check_hash,check_rhash:options.check_rhash,check_url:options.check_url,accept:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_14__.browser.safari?"":"video/*,"+window.VideoUpload.UPLOAD_ACCEPT}))};initButton()},_logUploadStatus:function(_,e){try{e.act="upload_stats",e.stage=_,ajax.post("al_video.php",e)}catch(_){}},removeUploadedThumb:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.cancelEvent)(e);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(o,{backgroundImage:""}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(o);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_tc_uploader",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_btn",i),d=window.VideoUpload.getPlaceholderEl(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"thumb-id",DEFAULT_THUMB_ID),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"thumb-hash",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"thumb-url",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a),d){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"main-thumb");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-url",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-id",DEFAULT_THUMB_ID);var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",i);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__player",l))&&VideoUpload.updatePlayerThumb(l),!1}return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-id",null),!1},initThumbUpload:function(_,e){if(_&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.isObject)(_)){var o,i,a,d=function(_){void 0===_&&(_=!0);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("popup_save_button"),i=null==e?void 0:e.querySelector(".js-video_upload__ready_button"),a=o||i,d=document.querySelector(".VideoLayout__stickyPanelButton");a&&(_?(_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.unlock(a),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.unlock(d)):(_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.lock(a),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.lock(d)))},t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_uploader",e),l={file_name:"photo",file_size_limit:1024*(_.file_size_limit_in_MB||50)*1024,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(_,l){o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_progress_wrap",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_progress_bar",e),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_btn",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,"width","0%"),d(!1)},onUploadComplete:function(_,e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,"width","0%"),!e)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a),void(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_18__.topError)("Thumb load error");var l=(0,_shared_lib_parse__WEBPACK_IMPORTED_MODULE_23__.parseJSON)(e);if(!l.photo_id)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a),void(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_18__.topError)(e);var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_image",t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(n,{backgroundImage:"url("+l.thumb.l+")"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"thumb-url",l.thumb.l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"thumb-id",l.photo_id+"_"+l.photo_owner_id),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"thumb-hash",l.photo_hash),window.VideoUpload.selectThumb(t),d()},onUploadProgress:function(_,e,o){var a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(e/o*100);a=Math.min(a,100),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,"width",a+"%")},onUploadError:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,"width","0%"),(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_18__.topError)("Thumb load error"),d()},clear:1,type:"photo",max_attempts:3,server:_.server,error:_.default_error,error_hash:_.error_hash,noCheck:!0,chooseBox:!0,label:_.specialLabel||cur.videoUploadThumbBtnTpl,uploadButton:!0,buttonClass:"js-video_tc_upload_btn",accept:".jpg,.jpeg,.png",filesize_hide_last:!0,lang:{filesize_error:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_thumb_size_error")}};Upload.init(t,_.url,_.vars,l)}},initLiveTransTimePicker:function(_,e){if(void 0===_&&(_={}),void 0===e&&(e=!1),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime--startTime")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime--endTime"))return!1;if(d("startTimePicker","start-time","VideoLiveTransTime__startTimePickerPopup",VideoUpload.updateStarTime),d("endTimePicker","end-time","VideoLiveTransTime__endTimePickerPopup",VideoUpload.updateEndTime),VideoUpload.updateStarTime(),VideoUpload.updateEndTime(),e&&VideoUpload.makeLiveEndDateOptional(),_.start_time){var o=1e3*_.start_time<Date.now();VideoUpload.showSavedLiveTimeSettings(o),0===_.end_time&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoLiveTransTime__optionalEnding")&&VideoUpload.makeLiveEndDateOptional()}function i(_,e){var o=e.start_time,i=e.end_time,a=Math.round(Date.now()/1e3);return"start-time"===_?o||a:i||a+DEFAULT_TIMER_GAP}function a(_){return"start-time"===_?MONTH_IN_MS:DAY_IN_MS}function d(e,o,d,t){var l="time-input_"+o,n=`datepicker-inline-container_${o}`,s=`\n          <td class="cal_clear" colspan="7">\n              <div class="VideoLiveTransTime__calendarFooter">\n                  <div id="${n}"></div>\n              </div>\n          </td>`,r=new Datepicker("date-input_"+o,{width:155,mode:"ts",onUpdate:t,noPast:!0,noFuture:!1,pastActive:!1,activePeriod:a(o),date:i(o,_),time:l,inlineTime:!0,inlineTimeContainerId:n,inlineTimeContainerIdx:o,addRows:s});return window.VideoUpload[e]=r,new ElementTooltip((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__"+e),{defaultSide:"top",autoShow:!1,cls:"VideoLiveTransTime__tooltip",noOverflow:!1,centerShift:0,noBorder:!0,content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(d),noHideOnClick:!0,align:ElementTooltip.ALIGN_LEFT,onHide:()=>{setTimeout((()=>{r&&r.hide(!0)}),ElementTooltip.FADE_SPEED)}}),r}},showStartTimePicker:function(_){VideoUpload.startTimePicker.toogle(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTimeEnabled"),"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__startTimePicker"),"VideoLiveTransTime__timePicker--hasTime"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ResetVideoLiveTransTime"),"ResetVideoLiveTransTime--hidden"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime--endTime"),"VideoLiveTransTime--hidden")},showSavedLiveTimeSettings:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTimeEnabled"),"on");var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__startTimePicker");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"VideoLiveTransTime__timePicker--hasTime"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"VideoLiveTransTime__timePicker--disabled",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePicker"),"VideoLiveTransTime__timePicker--hasTime"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ResetVideoLiveTransTime"),"ResetVideoLiveTransTime--hidden",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime--endTime"),"VideoLiveTransTime--hidden")},showEndTimePicker:function(_){VideoUpload.endTimePicker.toogle(_)},resetTimePickers:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__startTimePicker"),"VideoLiveTransTime__timePicker--hasTime"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime--endTime"),"VideoLiveTransTime--hidden"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ResetVideoLiveTransTime"),"ResetVideoLiveTransTime--hidden"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTimeEnabled"),"on");var _=new Date(Date.now());VideoUpload.setDatePickerDate(VideoUpload.startTimePicker,_,!0),VideoUpload.updateStarTime();var e=new Date(Date.now()+DEFAULT_TIMER_GAP);VideoUpload.setDatePickerDate(VideoUpload.endTimePicker,e,!0),VideoUpload.updateEndTime(),VideoUpload.resetLiveEndDateOptional()},updateStarTime:function(){var _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_start-time")));_=VideoUpload.validateSelectedTime(VideoUpload.startTimePicker,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__startTimePickerFormatTime"),VideoUpload.formatDate(_)),VideoUpload.endTimePicker.setActivePeriodStart(_),VideoUpload.updateEndTime()},updateEndTime:function(){var _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_end-time")));_=VideoUpload.validateSelectedTime(VideoUpload.endTimePicker,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePickerFormatTime"),VideoUpload.formatDate(_))},formatDate:function(_){_=(_=~~(_/1e3))+(60*(new Date).getTimezoneOffset()+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(vk.tz))+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(vk.dt);var e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("datepicker_dateFormat");"dateFormat"===e&&(e="{day} {month} {year}");var o=new Date(1e3*_),i=o.getDate(),a=o.getMonth()+1,d=o.getFullYear();return e.replace("{day}",i).replace("{month}",(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.winToUtf)((0,_web_datepicker_datepicker__WEBPACK_IMPORTED_MODULE_39__.getLangsForMonth)(a)[1])).replace("{year}",d)+` ${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("profile_wall_postpone_at")} `+`${o.getHours()}:${("0"+o.getMinutes()).slice(-2)}`},validateSelectedTime:function(_,e){var o=new Date(1e3*e),i=new Date,a=1e3*(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_start-time"))),d=1e3*(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_end-time")));if(VideoUpload.startTimePicker===_)if(o.getTime()>d){var t=new Date(o.getTime()+DEFAULT_TIMER_GAP);VideoUpload.setDatePickerDate(VideoUpload.endTimePicker,t,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePickerFormatTime"),VideoUpload.formatDate(t.getTime()))}else if(o.getTime()+DAY_IN_MS<d){var l=new Date(o.getTime()+DEFAULT_TIMER_GAP);VideoUpload.setDatePickerDate(VideoUpload.endTimePicker,l,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePickerFormatTime"),VideoUpload.formatDate(l.getTime()))}if(VideoUpload.endTimePicker===_){if(o.getTime()<a){var n=new Date(a+DEFAULT_TIMER_GAP);return VideoUpload.setDatePickerDate(_,n,!0),n.getTime()}if(o.getTime()>a+DAY_IN_MS){var s=new Date(a+DAY_IN_MS);return VideoUpload.setDatePickerDate(VideoUpload.endTimePicker,s,!0),s.getTime()}}return o.getTime()<i.getTime()?(VideoUpload.setDatePickerDate(_,i,!0),i.getTime()):o.getTime()},setDatePickerDate:function(_,e,o){_.setDate(e.getFullYear(),e.getMonth()+1,e.getDate(),!0,e.getHours(),e.getMinutes()),o&&(_.timePicker.hourDD.val(e.getHours()),_.timePicker.minDD.val(e.getMinutes()))},makeLiveEndDateOptional:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoLiveTransTime__optionalEnding"),"VideoLiveTransTime__optionalEnding--active"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePicker"),"VideoLiveTransTime__timePicker--invisible")},resetLiveEndDateOptional:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoLiveTransTime__optionalEnding"),"VideoLiveTransTime__optionalEnding--active"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTime__endTimePicker"),"VideoLiveTransTime__timePicker--invisible")},selectThumb:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"thumb-url"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"thumb-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"thumb-hash");if(o){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_tc_item",a),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(this,_.classList.contains("ThumbChooser__item")?"ThumbChooser__item--selected":"video_tc_item_selected",this==_)}));var d=window.VideoUpload.getPlaceholderEl(_);if(d){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-id",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-hash",i||""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"thumb-url",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(d,{backgroundImage:"url("+e+")"});var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__player",t))&&VideoUpload.updatePlayerThumb(t)}}},getPlaceholderEl:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"js-video_upload")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("video_edit",e)?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__thumb",e)},initTC:function(_,e,o,i){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__thumb_chooser_info",o);if(e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a.innerHTML,e);else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(a),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(_);var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video-upload-thumb-chooser",o);if(cur.is_showcase||i){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ThumbChooser",o);t&&(d=t)}d&&d.appendChild(_);var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_uploader",o);if(l){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_tc_slider_cont",o);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(l,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(n))}}},runVideoProgressUpdate:function(_,e,o,i,a,d,t,l,n){ajax.post("al_video.php?act=encode_progress",{owner_id:e,vid:o,hash:i,need_thumb:a,need_tc:d,is_showcase:cur.is_showcase,is_short_video:+n},{onDone:function(s){var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(r)){var E=!0,b=-1;if(s){if(s.error)return void window.VideoUpload.showError(r,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_encode_error"));if(a&&s.thumb){var u=window.VideoUpload.getPlaceholderEl(r);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(u,"main-thumb",s.thumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(u,"thumb-id")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(u,{backgroundImage:"url('"+s.thumb+"')"}),a=""}if(d&&(s.tc||s.tc_msg)&&(window.VideoUpload.initTC(s.tc,s.tc_msg,r,n),d=0,n)){var D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress",r);D.classList.add("VideoUploadItem__progress--success");var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress_text",D);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(p,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"lang-success")),void _web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setDisabled((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__ready_button",r),!1)}var c=s.duration;if(b=s.percents,s.is_claimed)return void Upload.onUploadError({ind:_.split("_")[1],uploadItemId:_},{code:"-5"});if(void 0!==c||s.is_uv_upload&&b>=0){if(void 0!==c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"duration",c),b>=100){if(t<100){VideoUpload.updatePlayer(r),s.published&&window.VideoUpload.setPublished(r);var m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress",r);m.classList.add("VideoUploadItem__progress--success");var P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress_text",m);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(P,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(P,"lang-success")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(r.querySelector(".VideoUploadItem__thumbStub")),a||d){var v=a?2:0;v+=d?1:0,window.VideoUpload._logUploadStatus("no_thumb",{status:v,vid:e+"_"+o})}}}else{var O=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_encode_percent").replace("{percent}",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(b));window.VideoUpload.setProgressValue(b,O,r,!0)}b>=100&&!a&&!d&&(E=!1)}else b=-1}E&&setTimeout(window.VideoUpload.runVideoProgressUpdate.pbind(_,e,o,i,a,d,b,l,n),1e3)}},onFail:function(){l||(l=1),setTimeout(window.VideoUpload.runVideoProgressUpdate.pbind(_,e,o,i,a,d,t,l+1,n),2e3*l)}})},updatePlayer:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("video_edit",_)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"owner_id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"video_id");if(e&&o){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"duration"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__player",_),d=`${e}_${o}`;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"video",d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.attr)(a,"href",`/video${e}_${o}`),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.attr)(a,"onclick","return VideoUpload.onThumbClick(this, event);"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a),i&&parseInt(i,10)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video-duration-label",a),(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_22__.formatTime)(i)),VideoUpload.updatePlayerThumb(_)}}},updatePlayerThumb:function(_){var e=window.VideoUpload.getPlaceholderEl(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"thumb-url");(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_16__.revertLastInlineVideo)();var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__player",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,{backgroundImage:"url("+o+")"})},showError:function(_,e,o){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress_text",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"error",1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(i,i.classList.contains("VideoUploadItem__progress")?"VideoUploadItem__progress--error":"_error"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__ready_button",_),!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a,e)},setPublished:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"published",1);var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_publish",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"disabled")||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.disable)(e)},setProgressValue:function(_,e,o,i){if(o){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress_bar",o),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress_text",o),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__progress",o);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(t,"VideoUploadItem__progress--processing",!!i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(a,{width:_+"%"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(d,e)}},saveParams:function(_,e,o,i){void 0===e&&(e=!1),void 0===o&&(o=!1),void 0===i&&(i=!1);var a=window.VideoUpload.getUploadItem(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"saved")&&!e&&!o)return VideoUpload.deleteParams(_,e),void VideoUpload.checkNeedShowStickyPanel();var d=i?window.VideoUpload.getShortParams(a):window.VideoUpload.getParams(a);if(d){if(!d.title||d.title.length>cur.videoTitleLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",a));if(d.desc.length>cur.videoDescriptionLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",a));_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setDisabled(_,!0),d.vid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"video_id"),d.oid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"owner_id")||cur.chosenOwnerId;var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"tag");d.tag=t,d.hash=cur.videoHashs[t],d.ext=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"extension"),nav.objLoc.ocl&&(d.ocl=1),ajax.post("al_video.php?act=save_video_params",d,{onDone:function(i){var t;(_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setDisabled(_,!1),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButtonAppearance.SECONDARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setLabel(_,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_back_to_editing")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",a).setAttribute("readonly","readonly"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",a).setAttribute("readonly","readonly"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("VideoUploadItem__warn",a).forEach((_=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(_,{visibility:"hidden",height:0,marginTop:0}))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(a,"saved",1),d.improve)&&(null==(t=a.querySelector(".video_improve_quality"))||t.classList.add("disabled"));if("published"===i&&window.VideoUpload.setPublished(a),!e){var l=["video_upload__tabs","js-video-upload-thumb-chooser","video_upload__secondary_info"];cur.is_showcase&&(a.classList.add("VideoUploadItem--collapsed"),l.push("VideoUploadItem__asideInfo","js-video-upload-album-chooser","js-video-upload-checkboxes")),l.forEach((_=>{var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)(_,a);(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideUp)(e,{duration:150,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.Fx.Transitions.swiftOut})}))}o||VideoUpload.checkNeedShowStickyPanel()}})}},saveShortVideoParams:function(_){var e,o=window.VideoUpload.getUploadItem(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload"),i=(null==(e=VideoUpload.options)?void 0:e[0])||{},a=window.VideoUpload.getShortParams(o);if(a){if(a.desc.length>cur.videoDescriptionLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)(o.querySelector(".js-video_upload__description"));_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setDisabled(_,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(o.querySelector(".js-video_upload__cancel")),a.vid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"video_id")||i.videoId,a.oid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"owner_id")||i.ownerId||cur.chosenOwnerId;var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"tag");a.hash=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"edit_hash"),a.tag=d,a.ext=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"extension");var t=a.oid<0?"/club"+Math.abs(+a.oid):"";nav.objLoc.ocl&&(a.ocl=1);var l=function(_,e){if(void 0===_&&(_=!1),void 0===e&&(e=""),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)())return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().hide(),window.Videoview&&Videoview.updateVideo(a.oid,a.vid,"",a.desc,"",!!e,"",_?"published":""),cur.videoEditItem&&!e&&_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(cur.videoEditItem.querySelector(".ShortVideoGridItem__unpublished")):e&&(cur.videoEditItem.querySelector(".ShortVideoGridItem__unpublishedText").innerHTML=e),void(i.publishAt>Math.trunc(Date.now()/1e3)&&!e&&!_&&nav.go(`/clips${t||a.oid}`));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"saved",1),_&&(a.publish_at?nav.go(`/clips/postponed${t}`):nav.go(`/clips${t||a.oid}`))};ajax.post("al_video.php?act=do_edit_box",a,{onDone:function(){var _=!!arguments[6],e=arguments[7];_||e?l(!1,e):((0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"publish",_shared_ranges__WEBPACK_IMPORTED_MODULE_40__.Ranges.isUserIdTransitional(a.oid)?"by_user":"by_group"),a.audio_id&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"adding_tracks",a.audio_id),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_publish_checkbox",(!!a.wallpost).toString()),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_allow_duets_checkbox",(!!a.can_make_duet).toString()),+a.oid>0&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_allow_comments_checkbox",(!a.privacy_videocomm).toString()),a.privacy_video&&VideoUpload.onPrivacyChangedStats(a.privacy_video),ajax.post("al_video.php?act=publish_clip",{owner_id:a.oid,video_id:a.vid,wallpost:a.wallpost,hash:a.hash,publish_at:a.publish_at,license_agree:1},{onDone:()=>l(!0)}))},onFail:function(){_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setDisabled(_,!1),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButtonAppearance.PRIMARY),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o.querySelector(".js-video_upload__cancel"))}})}},deleteParams:function(_,e){var o=window.VideoUpload.getUploadItem(_),i=function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"saved",null),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButtonAppearance.PRIMARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.setLabel(_,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_end_editing")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",o).removeAttribute("readonly"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",o).removeAttribute("readonly"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("VideoUploadItem__warn",o).forEach((_=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(_,{visibility:"visible",height:"auto",marginTop:"6px"})));var e=["video_upload__tabs","js-video-upload-thumb-chooser","video_upload__secondary_info"];cur.is_showcase&&(o.classList.remove("VideoUploadItem--collapsed"),e.push("VideoUploadItem__asideInfo","js-video-upload-album-chooser","js-video-upload-checkboxes")),e.forEach((_=>{var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)(_,o);(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideDown)(e,{duration:150,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.Fx.Transitions.swiftOut})}))};if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"published")&&!e)i();else{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.disableButton)(_,!0);var a=window.VideoUpload.getParams(o);a.vid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"video_id"),a.oid=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"owner_id"),a.tag=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"tag"),ajax.post("al_video.php?act=delete_video_params",a,{onDone:function(o){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.disableButton)(_,!1),e||i()},onError:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.disableButton)(_,!1)}})}},getParams:function(_){var e=_.id.substr("video_upload_item_".length),o=parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"owner_id"),10)||cur.chosenOwnerId,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_publish",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload_monetized",_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_edit_repeat",_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_improve_quality",_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_hide_auto_subs",_),r=0;window.VideoUpload._uploadAlbumChooser[e]&&(r=window.VideoUpload._uploadAlbumChooser[e].selectedItems()[0]);var E=window.VideoUpload.getPlaceholderEl(_),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(E,"thumb-id"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(E,"thumb-hash"),D={action_link:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",_)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",_).value:"",status_export:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(i),monetized:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(a),title:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(d),desc:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t),repeat:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(l),improve:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(n),hide_auto_subs:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(s),album_id:r?r[0]:"",thumb_id:b,thumb_hash:u};if(o>0)D.privacy_video=Privacy.getValue("video"+e),D.privacy_videocomm=Privacy.getValue("videocomm"+e);else if(Object.keys(cur.privacy).length){var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(cur.privacy.view.key,{id:e}),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(cur.privacy.comment.key,{id:e});D.privacy_video=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${p}_input`)),D.privacy_videocomm=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${c}_input`))}return D},getShortParams:function(_){var e,o=_.id.substr("video_upload_item_".length),i=_.querySelector(".video_upload_publish"),a=_.querySelector(".js-video_upload__description"),d=_.querySelector(".audio_row"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`postpone_date${null==(e=cur.videoUploadPostponePicker)?void 0:e.lnkId}`),l=Math.trunc(Date.now()/1e3),n=_.querySelector(".clip_publish"),s=_.querySelector(".clip_allow_duets"),r=_.querySelector(".clip_allow_comments"),E=window.VideoUpload.getPlaceholderEl(_),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(E,"thumb-id"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(E,"thumb-hash"),D={status_export:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(i),desc:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a),wallpost:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(n)?1:0,can_make_duet:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(s)?1:0,privacy_videocomm:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(r)?0:3,thumb_id:b,thumb_hash:u,privacy_video:Privacy.getValue("video"+o)};if(d&&(D.audio_id=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.attr)(d,"data-full-id")),t){if(+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t)<l)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("postpone_picker_error_message").classList.add(CSS_CLASS_ERROR_MESSAGE);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("postpone_picker_error_message").classList.remove(CSS_CLASS_ERROR_MESSAGE),D.publish_at=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t)}else D.publish_at=0;return D},getUploadItem:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_)},stopUpload:function(_){var e=_.split("_")[1],o=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)({width:430,title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_stop_title"),bodyStyle:"padding: 20px;"},(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_stop_text"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_stop_button"),(function(){o.hide(),Upload.terminateUpload(e);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"video_id");if(a){var d=Upload.vars[e];ajax.post("al_video.php?act=delete_video",{vid:a,oid:d.oid,sure:1})}window.VideoUpload.deleteItem((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+_),!0),window.VideoUpload.checkNeedShowStickyPanel()}))},deleteItem:function(_,e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("page_block",_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page_block_header",o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("ui_crumb",i),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload").map((_=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("page_block",_)));if(1===d.length)if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_),"clips_upload"===cur.module)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoEmptyStub"));else{var t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_no_video_upload_title");o.insertAdjacentHTML("beforeend",`<div id="video_upload_no_video">${t}</div>`),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a[a.length-1],(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_adding_video_title"))}else if(o===d[0]){var l=d[1],n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("page_block_header",l),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("_header_inner",l));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a[a.length-1],s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(n,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(o)}else e?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideUp)(o,{duration:150,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.Fx.Transitions.swiftOut,onComplete:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(o)}}):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cleanElems)(o)},initBeforeUnload:function(){cur.nav.push((function(_,e,o,i){if(!1===window.VideoUpload.checkChanges(1))return cur.onContinueCb=nav.go.pbind(o),!1})),window.onbeforeunload=window.VideoUpload.checkChanges,cur.destroy.push((()=>{window.onbeforeunload=!1,window.VideoUpload.destroyTab()}))},checkChanges:function(_){if(!cur.leaving){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_block");if(!e)return!1;for(var o="",i="",a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload",e),d=a.length,t=0,l=0,n="clips_upload"===cur.module,s=0;s<a.length;s++){var r=a[s];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"error")?d--:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"uploaded")&&t++,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"saved")&&l++)}if(t!==d)o=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_changed");else if(l!==d)if(n)i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_clip_upload_leaving_without_saving");else{var E=d-l;i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_leaving_without_saving",E)}if(1===_){if(!o&&!i)return!0;var b=_=>{cur.leaving=!0,_.hide(),cur.onContinueCb&&cur.onContinueCb()};if(o)var u=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_warning")},o,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_continue"),(()=>{b(u)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),(()=>{u.hide(),nav.objLoc.section="upload",nav.setLoc(nav.objLoc)}));else if(i){var D;n?((D=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.MessageBox({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_stop_editing_title"),containerClass:"video_upload__leave_editing_box"})).content(i),D.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_clip_upload_end_editing"),(()=>{D.hide(),window.VideoUpload.saveShortVideoParams((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__ready_button"))})),D.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),(()=>{D.hide()}),"no",!1)):((D=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.MessageBox({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_warning"),containerClass:"video_upload__leave_editing_box"})).content(i),D.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_save"),(()=>{D.hide(),cur.is_showcase||(nav.objLoc.section="upload",nav.setLoc(nav.objLoc)),window.VideoUpload.saveAllVideos()})),D.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_publish_later"),(()=>{b(D)}),"no",!1)),D.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_remove_video"),(()=>{a.forEach((_=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"saved")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"owner_id")||cur.chosenOwnerId,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"video_id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"tag"),a=cur.videoHashs[i];ajax.post("/al_video.php?act=a_delete_video",{oid:e,vid:o,from:cur.oid,pl_id:-2,hash:a,tag:i,is_short_video:+n},{onDone:()=>{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domQuery)(`[data-id="${e}_${o}"]`).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_)})),!cur.onContinueCb){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload");_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoEmptyStub")))}}})}})),b(D)}),"no",!1,"video_upload__remove_video_btn"),D.show()}return!1}var p=o||i;return p?(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.winToUtf)(p.replace(/<\/?b>/g,"").replace(/<br\s*\/?>/g,"\n")):void 0}},toUploadVideo:function(){var _=cur.uploadVideoBox;window.VideoUpload.checkResize(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_upload_box_tab"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_add_from_youtube_tab"),window.VideoUpload.onShowUploadPanel(),_.removeButtons(),_.setOptions({hideButtons:1,title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_header_new")}),_.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),_.hide,"no"),_.setBackTitle(),cur.uploadVideoBoxContainer.classList.remove("video_upload_box--with_actions")},toExternalAdd:function(_){var e=cur.uploadVideoBox,o="video"===_?this.toUploadVideo:e.hide;e.setBackTitle(o),window.VideoUpload.onHideUploadPanel(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_upload_box_tab"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_add_from_youtube_tab"),e.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("video_extra_settings")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("video_share_not_allowed")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("video_share_error")?(e.setOptions({hideButtons:0}),e.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_save"),cur.saveExternalVideo),cur.uploadVideoBoxContainer.classList.add("video_upload_box--with_actions")):(e.setOptions({hideButtons:1}),cur.uploadVideoBoxContainer.classList.remove("video_upload_box--with_actions")),e.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),e.hide,"no"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_link").focus()},toGroupVideoSelect:function(_){var e=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)();(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showBox)("al_video.php?act=a_choose_video_box",{from:"video",without_upload:!0},{onDone:function(_){var e=`<div class="back" onclick="curBox().hide();"><span class="back__icon">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_41__.getIcon24BrowserBack)().icon}</span>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_back")}</div>`;_.setOptions({title:e,defaultTitle:e})}}),cur.chooseVideoAdd=function(o,i,a){for(var d=new CallHub((function(){("groups"!=cur.module&&"public"!=cur.module||!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_37__.partConfigEnabled)("redesign_web_group_feature"))&&"video"!=cur.module?nav.go("/videos-"+_,!1,{onDone:function(){cur.__phinputs=cur.__phinputs||[],(0,_web_lib_nav_utils__WEBPACK_IMPORTED_MODULE_15__.globalHistoryDestroy)(nav.objLoc[0])}}):(nav.reload(),boxQueue.hideAll(),e.destroy())}),o.length),t=0,l=o.length;t<l;t++){var n=o[t],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_item_"+n),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"hash");n=n.split("_");var E=window.Video&&Video.isInAlbum()?Video._getSectionAlbumId():-2;ajax.post("al_video.php?act=a_add_to_playlist",{oid:n[0],vid:n[1],hash:r,gid:_,add:1,playlist_id:E},{onDone:function(){a&&a(),d.done()},onFail:function(){d.done()}})}return!1}},lockSaveButton:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.lockButton)((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().btns.ok[0])},unlockSaveButton:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.unlockButton)((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().btns.ok[0])},initShare:function(_,e,o){var i,a,d=cur.uploadVideoBox,t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_link");(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_20__.placeholderSetup)(t,{back:!0});var l,n=function(){var _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.trim)(t.value);_&&a!=_&&(d.showProgress(),a=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_form").submit())};function s(_){i&&clearTimeout(i),_.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.KEY.ENTER?n():i=setTimeout(n,1e3)}window.onParseDone=function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_server_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_error"),_.images_proxy){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_form").action.replace(/\/[^\/]*$/,"")+"/upload.php?act=proxy_img&";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(_.images_proxy,(function(o,i){_.images_proxy[o]=e+i}))}else _.images_proxy=_.images;if(_.extra>0&&_.extraData&&_.images[0]){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_descr"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_not_allowed"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_error"),d.hideProgress(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_url").value=_.url,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_image").value=_.images[0],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_extra").value=_.extra,cur.changeExternalImage=function(e){cur.externalVideoImage++,_.images[cur.externalVideoImage]?e.src=_.images_proxy[cur.externalVideoImage]:(cur.externalVideoImage=0,e.src=_.images_proxy[0])},_.images[0]){cur.externalVideoImage=0;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_image");if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,{backgroundImage:"url('"+_.images_proxy[0]+"')"}),i.setAttribute("onclick","cur.changeExternalImage(this)"),_.images.length>1){var a=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.vkImage)();a.src=_.images_proxy[0],a.onload=function(){a.width<130&&cur.changeExternalImage((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_img"))}}(n=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.vkImage)()).onerror=function(){var e=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(_.images_proxy,(function(_,o){if(0!=_){var a=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.vkImage)();a.onload=function(){e||(e=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_image").value=o,cur.externalVideoImage=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(i,{backgroundImage:"url('"+o+"')"}))},a.src=o}}))},n.src=_.images_proxy[0]}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_title").value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(_.title),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_description").value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(_.description),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_extra_settings"),cur.videoPlaylists.length?cur._addExternalAlbumDD=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_external_upload_album_chooser_input",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode),[[0,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_choose_album_placeholder")]].concat(cur.videoPlaylists),{autocomplete:!0,selectedItems:[0],big:!0}):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video-upload-album-chooser"));var t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_save");"video"!==o&&(t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_add"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_external_status_export"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video-upload-album-chooser")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(d.bodyNode,"video_upload_privacy_wrap"))),l=_,d.removeButtons(),d.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),d.hide,"no"),cur.saveExternalVideo=function(){_&&_.images&&(window.VideoUpload.lockSaveButton(),cur.shareExternalImageSave=_.images[cur.externalVideoImage],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_image").value=cur.shareExternalImageSave,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_photo_form").submit())},d.setOptions({hideButtons:0}),d.addButton(t,cur.saveExternalVideo),cur.uploadVideoBoxContainer.classList.add("video_upload_box--with_actions")}else-1==_.extra?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_not_allowed"),window.VideoUpload.unlockSaveButton()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_error"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_external_link"),window.VideoUpload.unlockSaveButton());var n},window.onParseFail=function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_server_error"),window.VideoUpload.unlockSaveButton(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_error"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_external_link")},window.onUploadDone=function(i,a){if(a.photo_id&&a.user_id&&l){var t=l.title;l.title=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_title").value;var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_description").value,s=0;if(cur.vSection){var r=cur.vSection.split("_");"album"===r[0]&&(s=r[1])}var E=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(l,{oid:_,folder_id:s,from:o,hash:e,share_title:t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_external_title").value,share_text:n,image_url:cur.shareExternalImageSave,photo_owner_id:a.user_id,photo_id:a.photo_id,extra:l.extra,extra_data:l.extraData,to_video:"video"===o?1:0,album_id:cur._addExternalAlbumDD?cur._addExternalAlbumDD.selectedItems()[0][0]:"",to_status:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_external_status_export")?1:0});E.openGraph&&delete E.openGraph,delete l.extraData,E.oid>0&&(E.privacy_video=Privacy.getValue("video_external"),E.privacy_videocomm=Privacy.getValue("videocomm_external")),delete E.images,delete E.images_proxy,setTimeout((function(){ajax.post("/al_video.php?act=save_external",E,{onDone:function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("share_error"),_.owner_id&&_.video_id)switch(o){case"video":d.hide(),nav.reload();break;case"market":d.hide();var e=_.owner_id+"_"+_.video_id;Video.attachVideos([e]);break;default:boxQueue.hideAll();var i=_.owner_id+"_"+_.video_id;Video.attachVideos([i])}else window.VideoUpload.unlockSaveButton(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_server_error")},onFail:function(_){window.VideoUpload.unlockSaveButton(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_share_server_error").innerHTML=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_server_error")}})}),0)}else d.showProgress(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_error")},window.onUploadFail=function(){d.hideProgress(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)("video_share_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("video_share_server_error")},(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.addEvent)(t,"paste blur",n),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.addEvent)(t,"keydown input",s),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_42__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.removeEvent)(t,"paste blur",n),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.removeEvent)(t,"keydown input",s)}))},showLiveKeyTab(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("video_upload__live_tab_content").forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,`video_upload__live_tab_content--${e}`))})),uiTabs.switchTab(_);var o=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)();if(o.removeButtons(),"constant"===e){var i=o.bodyNode.querySelector(".video_upload__live_tab_content--constant .VideoLiveCoderSettings__input--key");o.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_copy_live_constant_key_button"),window.VideoUpload.copyLiveKey.bind(null,null,i)),o.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_cancel_but"),o.hide,"no")}else o.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_save_but"),window.VideoUpload.saveLiveStream),o.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_cancel_but"),o.hide,"no")},showLiveVideoLeaveWarning(_){var e=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_warning"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_settings_leave_warning"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_continue"),(()=>{e.hide(),window.nav.go("/video",null,{onDone:()=>{window.VideoUpload.showLiveTypeModal(_)}})}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"),(()=>{e.hide()}))},showLiveTypeModal(_){if(void 0===_&&(_=cur.oid),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(_))return(0,_web_index__WEBPACK_IMPORTED_MODULE_34__.showQuickLoginBox)(),!1;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showBox)("al_video.php?act=a_add_live_type_selection",{owner_id:_},{stat:["video_edit.css"],onDone:function(_){_.setOptions({width:500}),_.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),_.titleWrap.classList.toggle("OwnerChooseWrapper--colorGrey",!0),_.removeButtons(),_.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_cancel_but"),_.hide,"neutral")},onFail:function(_){if(_)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().hide(),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_error"),_),!0}})},createLiveStream(_){if(void 0===_&&(_=cur.oid),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)(_))return(0,_web_index__WEBPACK_IMPORTED_MODULE_34__.showQuickLoginBox)(),!1;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showBox)("al_video.php?act=a_add_new_live_trans_form",{owner_id:_},{stat:["video_edit.css","privacy.css",window.jsc("web/privacy.js"),window.jsc("web/upload.js")],onDone:function(e,o){var i=o.owner_selected,a=void 0===i?1:i;e.setOptions({width:500}),cur.chosenOwnerId=_,e.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),e.removeButtons(),a||e.bodyNode.closest(".popup_box_container").classList.add("PopupStub"),cur.saveNewLiveTransBtn=e.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_save_but"),(()=>{window.VideoUpload.saveLiveStream()}),"ok",!0,"popup_save_button"),e.addButton((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_cancel_but"),e.hide,"no"),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_24__.autosizeSetup)("video_new_live_trans_description",{minHeight:60,maxHeight:160})},onFail:function(_){if(_)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().hide(),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_error"),_),!0}})},initWebStreamingForm:(_,e,o,i,a,d)=>{var t=document.getElementById("video_web_streaming_block");VideoUpload.initThumbUpload(e,t),VideoUpload.initLiveStreamCategoryDropdown(o,i),cur.resizeWebStreamingElementsHandler||(cur.resizeWebStreamingElementsHandler=!0,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_26__.addEvent)(window,"resize",window.VideoUpload.resizeWebStreamingElements)),cur.newLiveInfo={videoId:_.video_id,streamUrl:_.stream_url,streamName:_.stream_name},cur.newLiveHash=d.hash,cur.newLiveRandomTag=d.random_tag,cur.videoTitleLength=d.max_text_length.title,cur.videoDescriptionLength=d.max_text_length.description,a&&(cur.privacy=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.privacy||{},a),VideoUpload.initPrivacyControls(_.owner_id,a)),window.VideoUpload.showTab(t),window.VideoUpload.initActionLink()},initNewLiveTransFormBox:(_,e,o,i,a,d)=>{VideoUpload.initThumbUpload(e,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode),VideoUpload.initLiveStreamCategoryDropdown(o,i),cur.newLiveInfo={videoId:_.video_id,streamUrl:_.stream_url,streamName:_.stream_name},cur.newLiveHash=d.hash,cur.newLiveRandomTag=d.random_tag,cur.videoTitleLength=d.max_text_length.title,cur.videoDescriptionLength=d.max_text_length.description,a&&(cur.privacy=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.privacy||{},a),VideoUpload.initPrivacyControls(_.owner_id,a)),window.VideoUpload.showTab((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode),VideoUpload.initActionLink(),VideoUpload.initLiveTransTimePicker({},!0),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_24__.autosizeSetup)("video_new_live_trans_description",{minHeight:60,maxHeight:160})},updateLiveTypeModal:_=>{ajax.post("al_video.php?act=a_add_live_type_selection",{owner_id:_,update:1},{onDone:function(_){var e=JSON.parse(_).html,o=document.getElementById("video_add_live_wrapper");o&&(o.innerHTML="",o.insertAdjacentHTML("beforeend",e),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode.closest(".popup_box_container").classList.remove("PopupStub"),VideoUpload.updateLiveTypeModal())}})},updateNewLiveTransFormBox:_=>{ajax.post("al_video.php?act=a_add_new_live_trans_form",{owner_id:_,update:1},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.lockButton.pbind(cur.saveNewLiveTransBtn),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.unlockButton.pbind(cur.saveNewLiveTransBtn),onDone:function(_){var e=JSON.parse(_),o=e.liveInfo,i=e.uploadOptions,a=e.categories,d=e.gameCategories,t=e.privacyData,l=e.options,n=e.html,s=document.getElementById("video_add_live_wrapper");s&&(s.innerHTML="",s.insertAdjacentHTML("beforeend",n),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode.closest(".popup_box_container").classList.remove("PopupStub"),VideoUpload.initNewLiveTransFormBox(o,i,a,d,t,l),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().updateBoxCoords())}})},initVideoUploadBox:(_,e,o,i,a,d,t,l,n,s,r,E)=>{VideoUpload.buildExtMasks(E),VideoUpload.initUpload(_,e,i,E),VideoUpload.initShare(t,l,d),cur.privacy=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.extend)(cur.privacy||{},a),cur.videoTitleLength=r.title,cur.videoDescriptionLength=r.description,cur.videoPlaylists=n,cur.videoThumbUploadOpts=o,cur.videoUploadThumbBtnTpl=s},updateVideoUploadBox:function(_,e){void 0===e&&(e=!1),ajax.post("al_video.php?act=upload_box",{oid:_,update:1,is_short_video:+e,new_tpl:+e},{onDone:function(_,o,i){cur.newVideoUploadBlock=i,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode.innerHTML="",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode.insertAdjacentHTML("beforeend",o);var a=JSON.parse(_);VideoUpload.initUpload(a.upload_options,a.subtitles_upload_options,a.upload_tpl,e),VideoUpload.initShare(a.owner_id,a.hash_share,a.from),cur.privacy=a.privacy_data,cur.videoPlaylists=JSON.parse(a.playlists_data),cur.videoThumbUploadOpts=JSON.parse(a.thumb_upload_options),cur.videoUploadThumbBtnTpl=JSON.parse(a.thumb_upload_btn_tpl)}})},initLiveStreamCategoryDropdown:function(_,e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_live_category"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_live_game_category"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(o).offsetWidth;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("video_upload_live_game_category_wrap",3==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o)),window.VideoUpload._liveCategoryDropdown=new Dropdown(o,_,{multiselect:!1,zeroPlaceholder:!0,big:!0,width:a,onChange:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("video_upload_live_game_category_wrap",3==_)}}),window.VideoUpload._gameCategoryDropdown=new Dropdown(i,e,{multiselect:!1,zeroPlaceholder:!0,big:!0,width:a,onChange:function(){}}),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_42__.pushNavDestroy)((()=>{window.VideoUpload._liveCategoryDropdown.destroy(),window.VideoUpload._gameCategoryDropdown.destroy()}))},getLiveStreamCategoryVal:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_live_category"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_live_game_category");if(!_)return 0;var o=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_);if(3==o){var i=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e);o=i>0?i:o}return o},updateLiveTransSettings:function(_,e,o,i,a,d){ajax.post("al_video.php?act=generate_live_trans_keys",{rhash:a,hash:i,owner_id:cur.oid,video_id:_,need_new:e?1:0},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_live_trans_settings_url"+d,_.url),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_live_trans_settings_key"+d,_.key),o&&o()}})},updatedLiveKeyMsg:function(){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_trans_key_updated"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_trans_key_updated_msg"))},onLiveCoderSettingsFocus:function(_){"password"===_.type?this.toggleLiveKeyVisibility(null,_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(_,0,_.value.length)},toggleLiveKeyVisibility(_,e){if(e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_live_trans_settings_key"+_)),"password"===e.type){var o=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_view_key_box_title"),i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_view_key_box_msg"),a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_view_key_box_confirm"),d=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_view_key_box_cancel"),t=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)(o,i,a,l,d);function l(){t.hide(),e.type="text"}}else e.type="password"},copyLiveKey:function(_,e){e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_live_trans_settings_key"+_)),(0,_videoplayer_lib_clipboard__WEBPACK_IMPORTED_MODULE_32__.copyToClipboard)(e.value),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.showDoneBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_key_copied"),{out:1500})},saveWebStream:function(_,e){var o=document.getElementById(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_tc_item_selected",o),a=null,d=null;i&&(a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"thumb-id"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"thumb-hash"));var t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_new_live_trans_title")),l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_new_live_trans_description")),n=window.VideoUpload.getLiveStreamCategoryVal();cur.chosenOwnerId=e,cur.newLiveInfo=cur.newLiveInfo||{};var s={owner_id:cur.chosenOwnerId,video_id:cur.newLiveInfo.videoId,stream_url:cur.newLiveInfo.streamUrl,stream_name:cur.newLiveInfo.streamName,thumb_id:a,thumb_hash:d,title:t,description:l,start_time:0,end_time:0,category:n,publish:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_publish_on_wall"),preparation_check:0,notify_followers:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_notify_followers"),enable_donations:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_enable_donations"),forbid_rewind:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_forbid_rewind"),is_endless:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_endless"),rhash:cur.newLiveHash,random_tag:cur.newLiveRandomTag,action_link:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",o)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",o).value:"",is_web_streaming:1,webcast_preview:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_preparation_check")};if(localStorage.getItem("video_live_stream_name")&&localStorage.removeItem("video_live_stream_name"),localStorage.setItem("video_live_stream_name",cur.newLiveInfo.streamName),cur.chosenOwnerId>0?(s.privacy_view=Privacy.getValue("video_live_view"),s.privacy_comment=Privacy.getValue("video_live_comment")):(s.privacy_view=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.view.key}_input`)),s.privacy_comment=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.comment.key}_input`))),cur.call&&(s.call=!0),!s.title||s.title.length>cur.videoTitleLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_new_live_trans_title");if(s.description.length>cur.videoDescriptionLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_new_live_trans_description");if(!s.category){var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("selector_table","video_upload_live_category");if(r)return r.scrollIntoView({block:"center"}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)(r)}var E=document.getElementById("webcast_save_btn");_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.lock(E),ajax.post("al_video.php?act=a_add_new_live_trans",s,{onFail:function(_){return _web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_36__.FlatButton.unlock(E),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_create_live_error"),_||(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_create_live_error_try_later")),!0}})},saveLiveStream:function(){var _=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_tc_item_selected",_.bodyNode),o=null,i=null;e&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"thumb-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"thumb-hash"));var a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_new_live_trans_title")),d=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("video_new_live_trans_description")),t=window.VideoUpload.getLiveStreamCategoryVal(),l=!!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("VideoLiveTransTimeEnabled"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoLiveTransTime__optionalEnding"),"VideoLiveTransTime__optionalEnding--active"),s=l?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_start-time"))):0,r=l&&!n?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_end-time"))):0;cur.newLiveInfo=cur.newLiveInfo||{};var E={owner_id:cur.chosenOwnerId,video_id:cur.newLiveInfo.videoId,stream_url:cur.newLiveInfo.streamUrl,stream_name:cur.newLiveInfo.streamName,thumb_id:o,thumb_hash:i,title:a,description:d,start_time:s,end_time:r,category:t,publish:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_publish_on_wall"),preparation_check:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_preparation_check"),notify_followers:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_notify_followers"),enable_donations:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_enable_donations"),forbid_rewind:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_forbid_rewind"),is_endless:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_create_live_endless"),rhash:cur.newLiveHash,random_tag:cur.newLiveRandomTag,action_link:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",_.bodyNode)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",_.bodyNode).value:"",is_web_streaming:0};if(cur.chosenOwnerId>0?(E.privacy_view=Privacy.getValue("video_live_view"),E.privacy_comment=Privacy.getValue("video_live_comment")):(E.privacy_view=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.view.key}_input`)),E.privacy_comment=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.comment.key}_input`))),cur.call&&(E.call=!0),!E.title||E.title.length>cur.videoTitleLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_new_live_trans_title");if(E.description.length>cur.videoDescriptionLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("video_new_live_trans_description");if(!E.category){var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("selector_table","video_upload_live_category");if(b)return b.scrollIntoView({block:"center"}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)(b)}window.VideoUpload.lockSaveButton(),ajax.post("al_video.php?act=a_add_new_live_trans",E,{onFail:function(_){return window.VideoUpload.unlockSaveButton(),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_create_live_error"),_||(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_create_live_error_try_later")),!0}})},switchLiveEndlessCheckbox(_){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"skip-warning"))(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.checkbox)(_);else{var e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_endless_confirm_box_title"),o=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_endless_confirm_box_msg"),i=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_live_endless_confirm_box_yes_btn"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(`<div class="checkbox video_upload__live_endless_dont_warn_checkbox" onclick="checkbox(this)">${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_dont_warn_next_time")}</div>`),d=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_29__.showFastBox)(e,o,i,(()=>{d.hide(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.checkbox)(_),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(a)&&ajax.post("/al_video.php?act=skip_live_endless_warning",{hash:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"skip-warning-hash")},{onDone:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"skip-warning",1)}})}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("global_cancel"));d.bodyNode.appendChild(a)}},showTab(_,e){void 0===e&&(e="");var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"js-video_upload")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__tab",o)&&(e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__tab",o).dataset.type),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload__tab",o).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(_)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)(`video_upload__${e}`,o)),uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)(`video_upload__tab_${e}`,o),"ui_tab")))},initEdit(_,e,o,i,a,d,t){void 0===t&&(t=!1),cur.privacy=_;var l=VideoUpload.options[0],n=l.ownerId,s=l.videoId,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload");if((0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_24__.autosizeSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",r),{minHeight:80,maxHeight:250}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload__tab",r)),window.VideoUpload.showTab(r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_upload__tab_subtitles",r)&&(window.VideoUploadSubtitles[0].elems.blockEl=r,window.VideoUploadSubtitles.init(0)),e&&(cur.videoUploadThumbBtnTpl=i,VideoUpload.initThumbUpload(o,r),VideoUpload.initTC(e,"",r,!0)),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().setOptions({width:495}),a){if(a.uploaded_id){var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_upload_image",r);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(E,{backgroundImage:"url("+a.uploaded_url+")"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(E);var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_tc_uploader",r);b&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(b,"thumb-id",a.uploaded_id),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(b,"thumb-hash",a.uploaded_hash))}var u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_tc_item",r);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(u,(function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(this,"thumb-id")==a.selected)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(this,"video_tc_item_selected"),_>=3&&Video.tcSlide(null,this,Math.min(_-1,u.length-1),!0),!1}))}VideoUpload.initPrivacyControls(n,_),VideoUpload.initActionLink(n,s),VideoUpload.initLiveTransTimePicker(d),t&&l.publishAt&&VideoUpload.initPostponePicker(l.publishAt),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().removeButtons(),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().addButton(l.saveButtonTitle,t?VideoUpload.saveShortVideoParams:VideoUpload.editSaveVideo,"yes",!1,"popup_save_button")},initActionLink(_,e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input");o&&(o.value&&VideoUpload.updateActionLinkPreview(_,e),o.addEventListener("keyup",(0,_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_43__.debounce)((()=>{VideoUpload.updateActionLinkPreview(_,e)}),250)))},updateActionLinkPreview(_,e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-desc"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-error"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoEdit__actionLinkPreviewWrap");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)(a),o.value?ajax.post("al_video.php?act=get_action_link_preview",{owner_id:_,video_id:e,link:o.value},{cache:!0,onDone:function(_,e){_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(d),d.innerHTML=e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a)}}):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(i)},initPrivacyControls(_,e,o){void 0===o&&(o=0),_>0?e.is_live&&(Privacy.update("video_live_view"),Privacy.update("video_live_comment")):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)(e,(_=>{var i=e[_],a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i.key,{id:o});new InlineDropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(a),{items:i.items,selected:i.selected,onSelect:()=>{window.VideoUpload.updateUploadOptions(o)}})}))},initPostponePicker(_){void 0===_&&(_=0);var e=Math.trunc(Date.now()/1e3);_||(cur.postponedLastDate=e),cur.videoUploadPostponePicker=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("postpone_picker"),"postpone_picker_preview",[["postpone",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_clip_time_label"),{date:_||e,postpone_item_hidden:!1}]],{onResetPostponeBtnClick:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`postpone_date${cur.videoUploadPostponePicker.lnkId}`),e)},onMediaRemove:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`postpone_date${cur.videoUploadPostponePicker.lnkId}`),e)},date:_},"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("postpone_picker_btn")),_>e&&cur.videoUploadPostponePicker.chooseMedia("postpone",_,{date:_,postpone_item_hidden:!1})},editSaveVideo(_){var e,o,i,a,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("js-video_upload",_),t=(null==(e=VideoUpload.options)?void 0:e[0])||{},l=null;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_tc_item",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().bodyNode),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(this,"video_tc_item_selected"))return(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(this,"thumb-id"))||(l=DEFAULT_THUMB_ID),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(this,"thumb-hash"),!1}));var n=parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.$)(".VideoEdit__fieldIsShortVideo").value),s=Videoview.getPlayerObject(),r=cur.mvMoveToAlbum?cur.mvMoveToAlbum.val():"",E={act:t.isPublish?"save_video_params":"do_edit_box",title:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",d)),desc:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",d)),vid:t.videoId,oid:t.ownerId,hash:t.hash,action_link:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",d)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-action-link-input",d).value:"",action_link_title_key:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoEdit__actionLinkTitleKey",d)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoEdit__actionLinkTitleKey",d).value:"",album_id:r,thumb_id:l,thumb_hash:a,is_web_streaming:+cur.is_web_streaming};if(t.isPublish&&(E.status_export=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_publish")),-1==r&&(E.album_title=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("mv_create_album"),!E.album_title))return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)("mv_create_album");E.oid>0?(E.privacy_video=Privacy.getValue(`video${t.videoId}`),E.privacy_videocomm=Privacy.getValue(`videocomm${t.videoId}`)):(E.privacy_video=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.view.key}_input`)),E.privacy_videocomm=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`${cur.privacy.comment.key}_input`))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_edit_repeat")&&(E.repeat=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_repeat"),s&&s.toggleLoop(E.repeat));var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_hide_auto_subs",d);b&&(E.hide_auto_subs=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(b));var u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("video_improve_quality",d);if(u&&(E.improve=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)(u)),!(null==(o=E.title)?void 0:o.trim())&&!n||(null==(i=E.title)?void 0:i.length)>cur.videoTitleLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__title",d));if(E.desc.length>cur.videoDescriptionLength)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__description",d));if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_live_category")&&(E.live_category=VideoUpload.getLiveStreamCategoryVal(),!E.live_category)){var D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("selector_table","video_upload_live_category");if(D)return D.scrollIntoView({block:"center"}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.notaBene)(D)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_edit_live_preparation")&&(E.live_preparation=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_live_preparation")?1:0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_edit_live_endless")&&(E.live_endless=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_live_endless")?1:0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_edit_live_forbid_rewind")&&(E.live_forbid_rewind=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_live_forbid_rewind")?1:0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_edit_live_donations")&&(E.live_donations=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("video_edit_live_donations")?1:0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("VideoLiveTransTimeEnabled")){var p=!!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.isChecked)("VideoLiveTransTimeEnabled"),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("VideoLiveTransTime__optionalEnding"),"VideoLiveTransTime__optionalEnding--active");E.start_time=p?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_start-time"))):0,E.end_time=p&&!c?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_27__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("date-input_end-time"))):0}if(t.withSubtitles&&window.VideoUploadSubtitles[0]&&!window.VideoUploadSubtitles[0].tracksSaved)window.VideoUploadSubtitles.saveEditedTracks(0,VideoUpload.editSaveVideo);else if(window.ShortVideoGrid&&((0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"publish",_shared_ranges__WEBPACK_IMPORTED_MODULE_40__.Ranges.isUserIdTransitional(+E.oid)?"by_user":"by_group"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"privacy","all"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_publish_checkbox","false"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_allow_duets_checkbox","false"),+E.oid>0&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_38__.statlogsValueEvent)("clips_uploader",1,"clip_allow_comments_checkbox","false")),ajax.post(`al_video.php?act=${E.act}`,E,{onDone:function(){var _,e,o,i,a,d,t;if("save_video_params"===E.act?(t=arguments[0],_=arguments[1],e=arguments[2],i=arguments[3]):(_=arguments[0],e=arguments[1],o=arguments[2],i=arguments[3],a=arguments[4],d=arguments[5]),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)()){if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.curBox)().hide(),window.Videoview&&i&&Videoview.updateVideo(E.oid,E.vid,_,e,o,a,d,t),cur.videoEditItem&&i)if(window.ShortVideoGrid)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("ShortVideoGridItem__unpublished",cur.videoEditItem));else{var l=Video.buildVideoEl(i,cur.is_showcase);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(cur.videoEditItem).replaceChild(l,cur.videoEditItem),cur.videoEditItem=!1,Video._reinitSorters()}Video._updateThumbsInView()}},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_28__.unlockButton.pbind(_)}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mv_edit_album")){var m=[];m&&(cur.mvMoveToAlbum=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mv_edit_album"),m,{width:250,selectedItems:[],autocomplete:m.length>7,big:1,onChange:function(_){-1==_?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideDown)("mv_edit_create_album",200,(function(){(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_20__.placeholderSetup)("mv_create_album",{back:!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mv_create_album").focus()})):(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.slideUp)("mv_edit_create_album",200)}}))}else cur.mvMoveToAlbum=!1},updateUploadOptions(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner_id")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"video_id")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"view_hash_by_link")?window.VideoUpload.updateVideoLink(_):ajax.post("al_video.php?act=get_hash_by_link",{owner_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner_id"),video_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"video_id")},{onDone:o=>{o&&o.hash_by_link&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"view_hash_by_link",o.hash_by_link),window.VideoUpload.updateVideoLink(_))}}))},updateVideoLink(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("video_upload_item_"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload_link",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"video_id");if(o&&i){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"view_hash_by_link"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"tag"),t=3==+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`privacy_video_view_${d}_input`)),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(o,"href-tpl");t&&!a&&window.VideoUpload.updateUploadOptions(_);var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(l,{video_id:i});t&&(n+=`?list=${a}`),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o,n),o.removeAttribute("placeholder");var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass1)("js-video_upload__copy_video_link",e);s.onclick=()=>{(0,_videoplayer_lib_clipboard__WEBPACK_IMPORTED_MODULE_32__.copyToClipboard)(n),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_25__.showDoneBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_33__.getLang)("video_upload_link_copied"),{out:1500}),o.focus()},(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(s)}},getUniqueUploadItemId:(_,e)=>e?`${Math.abs((0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_35__.hashCode)(_+e))}_${_}`:_,saveAllVideos(){for(var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload__ready_button"),e=0;e<_.length;e++){var o=_[e];window.VideoUpload.saveParams(o,!1,!0)}},checkNeedShowStickyPanel(){for(var _=0,e=document.querySelector(".VideoLayout__stickyPanel"),o=document.querySelector(".VideoLayout__scrollTop"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("js-video_upload__ready_button"),a=0;a<i.length;a++)if(i[a].classList.contains("FlatButton--primary")&&_++,2===_){null==e||e.classList.add("VideoLayout__stickyPanel--visible"),null==o||o.classList.add("VideoLayout__scrollTop--withGap");break}_<2&&(null==e||e.classList.remove("VideoLayout__stickyPanel--visible"),null==o||o.classList.remove("VideoLayout__scrollTop--withGap"))}}},591453:(_,e,o)=>{"use strict";o.d(e,{VideoUploadSubtitles:()=>E});o(66992),o(821249),o(747042),o(241539),o(788674),o(115306),o(454747),o(333948);var i=o(897449),a=o(70162),d=o(733164),t=o(520820),l=o(342269),n=o(285164),s=o(873589),r=o(146143),E={init(_){var e=E[_];e.elems.tracksLangDropdown={},e.isEditing&&(e.subtitlesListAdd=[]);var o=!!e.options&&e.subtitlesList;if((0,d.isObject)(o)&&!(0,d.isEmpty)(o)){for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];a.key=i,this.initTrack(_,a)}}else this.initTrack(_);this.initDefaultDropdown(_)},initTrack(_,e){void 0===e&&(e=!1);var o=E[_].elems.blockEl,i=(0,s.geByClass1)("js-add-subtitles-track",o);this.initNewTrackEl(i,e)},initNewTrackEl(_,e){void 0===e&&(e=!1);var o=(0,s.gpeByClass)("js-video_upload",_),d=(0,s.geByClass1)("js-upload-subtitles-wrapper",o),t=(0,s.geByClass1)("js-subtitles-upload-item",d).cloneNode(!0),l=o.id.substr("video_upload_item_".length);(0,s.domInsertBefore)(t,_);var n=0;(0,s.geByClass)("js-subtitles-upload-item",o).forEach((_=>{(0,s.isVisible)(_)&&(n++,(0,s.geByClass1)("js-subtitles-label",_).innerHTML=(0,a.getLang)("video_upload_upload_subtitle_label").replace("{index}",n))})),n>=E[l].options.max_tracks_num&&(0,s.hide)(_),this.initLangDropdown(l,t,e);var r=(0,s.geByClass1)("js-subtitle-track-name",t),b=(0,s.geByClass1)("js-subtitle-upload-btn",t),u=(0,s.geByClass1)("js-subtitle-remove-file",t);if(e){var D=e.hasOwnProperty("params")?e.params.full_name:e.name;this.decorateLangName(r,D),(0,i.disableButton)(b,!1),(0,s.hide)(b),(0,s.domData)(t,"track-id",e.key)}else(0,s.hide)(u),(0,s.hide)(r)},initDefaultDropdown(_){var e,o=E[_],a=o.elems.blockEl,t=(0,s.domByClass)(a,"js-video_upload__upload_subtitles"),l=o.subtitlesDefault;e=l==n.VIDEO_UPLOAD_SUBTITLES_DISABLED||l==n.VIDEO_UPLOAD_SUBTITLES_USER_LANG?l==n.VIDEO_UPLOAD_SUBTITLES_USER_LANG&&(0,d.isObject)(o.subtitlesList)?-1:-2:null!=l?o.subtitlesList[l].lang_id:-2;var r,b,u=this.getActualDefaultDropdownOptions(_),D=t.elements.subtitle_default;cur.is_showcase&&(r=(null==(b=document.querySelector(".VideoUploadItem__main"))?void 0:b.clientWidth)/2);o.elems.defaultLangDropdown=new Dropdown(D,u,{big:!0,width:r,selectedItems:e,onChange:()=>{this.updateDefaultLang(a)}});var p=o.elems.defaultLangDropdown.container;u.length>1?((0,i.enableEl)(p),(0,s.removeClass)(p,"disabled")):((0,i.disableEl)(p),(0,s.addClass)(p,"disabled"))},decorateLangName(_,e){_&&e&&(_.setAttribute("title",e),e.length>30&&(e=e.slice(0,27)+"…"+e.slice(-4)),_.innerText=e)},getCurrentAvailableLangs(_){var e=E[_],o=e.elems.blockEl,i=[];(0,s.geByClass)("js-subtitles-upload-item",o).forEach((_=>{if((0,s.isVisible)(_)){var e=(0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',_));e&&i.push(e)}}));var a=[];return(0,l.each)(e.options.langs,((_,e)=>{(0,l.inArray)(_,i)||a.push([_,e])})),a},getActualDefaultDropdownOptions(_){var e=E[_],o=e.elems.blockEl,i=(0,s.geByClass)("js-subtitles-upload-item",o),d=[],t=[];return d.push([-2,(0,a.getLang)("video_upload_subtitles_default_off")]),i.forEach((_=>{if((0,s.isVisible)(_)){var o=(0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',_)),i=(0,s.domByClass)(_,"js-subtitle-track-name");(0,s.isVisible)(i)&&t.push([o,e.options.langs[o]])}})),t.length&&(d.push([-1,(0,a.getLang)("video_upload_subtitles_default_user_lang")]),d.push(...t)),d},getActualSelectedLangIds(_){return this.getActualDefaultDropdownOptions(_).map((_=>_[0]))},initLangDropdown(_,e,o){var a,d,t=(0,s.domQuery1)('input[name="subtitle_lang"]',e),l=(0,s.domByClass)(e,"video_upload__subtitles_track_loading");((0,s.hide)(l),cur.is_showcase)&&(a=(null==(d=document.querySelector(".VideoUploadItem__main"))?void 0:d.clientWidth)/2);var n=(0,s.geByClass1)("js-subtitle-upload-btn",e),r=new Dropdown(t,this.getCurrentAvailableLangs(_),{autocomplete:!0,big:!0,width:a,placeholder:(0,s.domData)(t,"placeholder"),selectedItems:o?o.lang_id:"",onChange:e=>{var o=(0,s.domData)(r.container,"last-saved");if(o&&""===e)r.val(o);else if(""!==e){(0,s.domData)(r.container,"last-saved",e);var a=(0,s.gpeByClass)("js-subtitles-upload-item",r.container);(0,i.disableButton)(n,!1),this.updateAllLangDropdowns(_),e||(0,i.disableButton)(n,!0),this.onUpdateLang(a)}}});this.initUploadButton(_,n),E[_].elems.tracksLangDropdown[r.guid]=r},initUploadButton(_,e){var o=E[_],d=o.elems.blockEl,n=(0,s.gpeByClass)("js-subtitles-upload-item",e),b=(0,s.domByClass)(n,"selector_container"),u=(0,s.domByClass)(n,"video_upload__upload_subtitles_input_container"),D=(0,s.domByClass)(n,"video_upload__subtitles_track_loading"),p=(0,s.domByClass)(n,"js-subtitle-track-name"),c=(0,s.domByClass)(n,"js-subtitle-remove-file"),m=o.options;e.onclick=()=>{(0,s.domFC)(u).click()};var P=null;Upload.init(u,"",{},{accept:".srt",chooseBox:!0,clear:!0,file_name:"file",file_size_limit:m.file_size_limit,file_types:"*.srt",lang:{filesize_error:(0,a.getLang)("video_upload_subtitles_size_error")},max_attempts:3,noCheck:!0,requestOptionsForFile:!0,type:"subtitles",withoutAutoUpload:!0,onFilesSelected:(a,d)=>{if(d.length){if(P=d[0],(0,s.domData)(n,"upload-index",a),(0,s.hide)(e),o.isEditing)return(0,s.show)(p),(0,s.show)(c),this.decorateLangName(p,P.name),this.updateDefaultLangDropdown(_),void o.subtitlesListAdd.push(n);(0,s.show)(D),(0,i.disableEl)(b),(0,s.addClass)(b,"disabled"),E.uploadTrack(n)}},onNoFilteredCallback:()=>{(0,i.notaBene)(b),(0,r.showFastBox)((0,a.getLang)("global_error"),(0,a.getLang)("video_upload_subtitles_format_error"))},onUploadStart:(_,e)=>{(0,s.hide)(p),(0,s.hide)(c),(0,s.show)(D),(0,i.disableEl)(b),(0,s.addClass)(b,"disabled")},onUploadComplete:(o,a)=>{(0,s.hide)(D),(0,s.show)(p),(0,i.enableEl)(b),(0,s.removeClass)(b,"disabled"),this.decorateLangName(p,P.name),this.updateDefaultLangDropdown(_),(0,s.hide)(e),(0,s.show)(c);var n=(0,t.parseJSON)(a);(0,l.each)(n,((_,e)=>{(0,s.geByClass)("js-subtitles-upload-item",d).forEach((o=>{(0,s.isVisible)(o)&&(+(0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',o))==+e.lang_id&&(0,s.domData)(o,"track-id",_))}))})),this.updateDefaultLang(d),VideoUpload.updatePlayer(d)},onUploadError:(_,o)=>{(0,s.hide)(D),(0,s.show)(e),(0,i.enableEl)(b),(0,s.removeClass)(b,"disabled")}})},removeTrack(_){var e=(0,s.gpeByClass)("js-video_upload",_),o=(0,s.gpeByClass)("js-subtitles-upload-item",_),i=(0,s.geByClass1)("js-add-subtitles-track",e),d=(0,s.geByClass1)("js-subtitle-remove-file",o),t=e.id.substr("video_upload_item_".length);this.removeTrackFile(d),(0,s.hide)(o);var l=0;(0,s.geByClass)("js-subtitles-upload-item",e).forEach((_=>{(0,s.isVisible)(_)&&(l++,(0,s.geByClass1)("js-subtitles-label",_).innerHTML=(0,a.getLang)("video_upload_upload_subtitle_label").replace("{index}",l))})),l<E[t].options.max_tracks_num&&(0,s.show)(i)},removeTrackFile(_,e,o){void 0===o&&(o=!1);var i=(0,s.gpeByClass)("js-video_upload",_),a=(0,s.gpeByClass)("js-subtitles-upload-item",_),d=(0,s.geByClass1)("file",(0,s.geByClass1)("video_upload__upload_subtitles_input_container",a)),t=(0,s.geByClass1)("js-subtitle-upload-btn",a),l=(0,s.geByClass1)("video_upload__subtitles_track_loading",a),n=(0,s.geByClass1)("js-subtitle-track-name",a),r=i.id.substr("video_upload_item_".length),b=E[r];return(e=e||(0,s.domData)(a,"track-id"))===(0,s.domData)(a,"track-id")&&((0,s.val)(d,""),(0,s.hide)(_),(0,s.hide)(n)),this.updateDefaultLangDropdown(r),b.isEditing&&!o?((0,s.show)(t),(0,s.domData)(a,"track-id",""),void(e&&(b.subtitlesList[e].remove=_))):e?(e===(0,s.domData)(a,"track-id")&&((0,s.show)(l),(0,s.hide)(t)),new Promise(((_,o)=>{ajax.post("video?act=edit_subtitles_track",{action:"remove",owner_id:b.ownerId,video_id:b.videoId,track_id:e,hash:b.editHash},{onDone:()=>(e===(0,s.domData)(a,"track-id")&&((0,s.hide)(l),(0,s.show)(t),(0,s.domData)(a,"track-id","")),VideoUpload.updatePlayer(i),_()),onFail:_=>o(_)})}))):void(0,s.show)(t)},onUpdateLang(_,e){void 0===e&&(e=!1);var o=(0,s.domData)(_,"track-id"),i=(0,s.gpeByClass)("js-video_upload",_),a=i.id.substr("video_upload_item_".length),d=(0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',_)),t=E[a];if(this.updateDefaultLangDropdown(a),o){if(!t.isEditing||e){var l=(0,s.geByClass1)("video_upload__subtitles_track_loading",_),n=(0,s.domByClass)(_,"js-subtitle-remove-file"),r=(0,s.geByClass1)("js-subtitle-track-name",_);return(0,s.hide)(n),(0,s.hide)(r),(0,s.show)(l),new Promise(((_,e)=>{ajax.post("video?act=edit_subtitles_track",{action:"edit_lang",owner_id:t.ownerId,video_id:t.videoId,lang_id:d,track_id:o,hash:t.editHash},{onDone:()=>((0,s.hide)(l),(0,s.show)(n),(0,s.show)(r),this.updateDefaultLang(i),VideoUpload.updatePlayer(i),_()),onFail:_=>e(_)})}))}t.subtitlesList[o].update=_}},onVideoUploaded(_,e){var o=E[_];o.videoId=e;var i=o.elems.blockEl;(0,s.geByClass)("js-subtitles-upload-item",i).forEach((_=>{E.uploadTrack(_)}))},saveEditedTracks(_,e){var o,i,a=E[_],d=null==(o=a.elems)?void 0:o.blockEl,t=[],l=a.subtitlesList;null==(i=a.subtitlesListAdd)||i.forEach((_=>{t.push((()=>E.uploadTrack(_)))}));var n=function(_){if(!l.hasOwnProperty(_))return"continue";var e=l[_];e.hasOwnProperty("remove")?t.push((()=>E.removeTrackFile(e.remove,_,!0))):e.hasOwnProperty("update")&&t.push((()=>E.onUpdateLang(e.update,!0)))};for(var s in l)n(s);t.reduce(((_,e)=>_.then(e)),Promise.resolve()).then((()=>{Promise.all(t).then((()=>{var _=E.updateDefaultLang(d,!0);_?_.then((()=>{a.tracksSaved=!0,e()})):(a.tracksSaved=!0,e())}))}))},updateAllLangDropdowns(_){var e=E[_];for(var o in e.elems.tracksLangDropdown){if(e.elems.tracksLangDropdown.hasOwnProperty(o))e.elems.tracksLangDropdown[o].setOptions({defaultItems:this.getCurrentAvailableLangs(_)})}},updateDefaultLang(_,e){if(void 0===e&&(e=!1),_){var o=_.id.substr("video_upload_item_".length),i=E[o];if(i.editHash){var a=null,d=i.elems.defaultLangDropdown.val(),t=i.elems.defaultLangDropdown.container;if(-1!=d&&-2!=d)(0,s.geByClass)("js-subtitles-upload-item",_).forEach((_=>{(0,s.isVisible)(_)&&((0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',_))===d&&(a=(0,s.domData)(_,"track-id")))}));else a=-2==+d?n.VIDEO_UPLOAD_SUBTITLES_DISABLED:n.VIDEO_UPLOAD_SUBTITLES_USER_LANG;if((!i.isEditing||e)&&null!==a&&a!=(0,s.domData)(t,"last-saved"))return new Promise(((e,o)=>{ajax.post("video?act=edit_subtitles_track",{action:"set_default",owner_id:i.ownerId,video_id:i.videoId,track_id:a,hash:i.editHash},{onDone:()=>((0,s.domData)(t,"last-saved",a),VideoUpload.updatePlayer(_),e()),onFail:_=>o(_)})}))}}},updateDefaultLangDropdown(_){var e=E[_],o=e.elems.blockEl,a=e.elems.defaultLangDropdown,d=a.container,t=a.val(),n=this.getActualDefaultDropdownOptions(_);if(a.setOptions({defaultItems:n}),!(0,l.inArray)(t,this.getActualSelectedLangIds(_))){var r=e.subtitlesDefault,b=(0,s.domQuery1)(`.js-subtitles-upload-item[data-track-id="${r}"]`),u=(0,s.geByClass1)("js-subtitle-remove-file",b);b&&(0,s.isVisible)(u)?a.val((0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',b))):a.val(-2)}n.length>1?((0,i.enableEl)(d),(0,s.removeClass)(d,"disabled")):((0,i.disableEl)(d),(0,s.addClass)(d,"disabled")),this.updateDefaultLang(o)},uploadTrack(_){var e=(0,s.gpeByClass)("js-video_upload",_).id.substr("video_upload_item_".length),o=E[e],i=o.ownerId,a=o.videoId;if(a){var d=(0,s.geByClass1)("file",(0,s.geByClass1)("video_upload__upload_subtitles_input_container",_));if(d){var t=(0,s.domData)(_,"upload-index"),n=(0,s.val)((0,s.domQuery1)('input[name="subtitle_lang"]',_)),r=d.files;if(r.length)return new Promise(((_,o)=>{ajax.post("al_video.php?act=get_subtitles_upload_params",{oid:i,vid:a},{onDone:o=>{E[e].editHash=o.edit_hash,o.vars.langId=n,o.vars.name=r[0].name,(0,l.extend)(Upload.options[t],o.options),(0,l.extend)(Upload.vars[t],o.vars),Upload.uploadUrls[t]=o.options.url;var i=Upload.options[t].onUploadComplete;Upload.options[t].onUploadComplete=(e,o)=>(i(e,o),_()),Upload.onFileApiSend(t,r,!0)},onFail:_=>(Upload.terminateUpload(t,r[0].name),o(_))})}))}}}}},15944:(_,e,o)=>{"use strict";o.d(e,{copyToClipboard:()=>d});var i=o(873589),a=o(840060);function d(_,e){var o;void 0===e&&(e=window.utilsNode);var d=(0,i.ce)("textarea",{value:_},{position:"absolute",top:-9999,zIndex:2});e.appendChild(d),a.browser.msie?d.setSelectionRange(0,_.length):d.select();try{o=document.execCommand("copy")}catch(_){o=!1}return d.parentNode.removeChild(d),o}},285164:(_,e,o)=>{"use strict";o.d(e,{SHORT_VIDEO_UPLOAD_EXTS:()=>d,VIDEO_UPLOAD_EXTS:()=>t,VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>l,CLIP_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>n,VIDEO_UPLOAD_CHUNK_SIZE:()=>s,VIDEO_UPLOAD_FILE_THREAD_NUMBER:()=>r,VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER:()=>E,VIDEO_UPLOAD_SUBTITLES_DISABLED:()=>b,VIDEO_UPLOAD_SUBTITLES_USER_LANG:()=>u});var i=o(570655),a=o(840060),d="avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),t=(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(d),!1),["torrent"],!1);"avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf torrent".split(" ");a.browser.safari||d.join(",.");var l=5,n=1,s=4194304,r=4,E=10,b=-1,u=-2},465700:(_,e,o)=>{"use strict";o.r(e);var i=o(840103),a=o(897449),d=o(591453),t=o(256152),l=o(182804),n=o(290846);window.VideoUpload=i.VideoUpload,window.VideoUploadSubtitles=d.VideoUploadSubtitles,window.VideoInlineUpload=t.default;try{window.stManager.done("video_upload.js")}catch(_){}(0,l.tq)().setInteractiveHandler("VideoUpload/pick_from_my_videos",(function(_){var e,o=(null!==(e=_.payload.dataAttrs)&&void 0!==e?e:{}).groupId;i.VideoUpload.toGroupVideoSelect(o)})),(0,l.tq)().setInteractiveHandler("VideoUpload/improve_quality",(function(_){var e,o=null===(e=_.payload.target)||void 0===e?void 0:e.closest(".video_improve_quality");(null==o?void 0:o.classList.contains("disabled"))||(0,a.checkbox)(o)})),(0,l.tq)().setInteractiveHandler("VideoUpload/show_improve_quality_tooltip",(function(_){var e,o,i=null===(e=_.payload.target)||void 0===e?void 0:e.closest(".video_improve_quality.disabled:not(.cant-improve)");if(i){var a=(null!==(o=_.payload.dataAttrs)&&void 0!==o?o:{}).text;(0,n.showTooltip)(i,{text:a,dir:"top",shift:[22,10]})}})),(0,l.tq)().setInteractiveHandler("VideoUpload/hide_tooltip",(function(_){var e,o,i=null===(e=_.payload.target)||void 0===e?void 0:e.closest(".video_improve_quality.disabled:not(.cant-improve)");i&&(null===(o=window.tooltips)||void 0===o||o.hide(i))})),(0,l.tq)().setInteractiveHandler("VideoUpload/show_thumb_remove_tooltip",(function(_){var e=_.payload,o=e.dataAttrs,i=e.target,a=(o||{}).text,d=i;d&&(0,n.showTooltip)(d,{text:a,dir:"bottom",center:!0,typeClass:"tt_black",className:"VideoWebcastFormHint",shift:[-20,-12],appendEl:document.querySelector(".VideoWebcastForm__aside")||void 0})})),(0,l.tq)().setInteractiveHandler("VideoUpload/remove_uploaded_thumb",(function(_){var e=_.payload,o=e.target,a=e.event,d=o;i.VideoUpload.removeUploadedThumb(d,a)}))}}]);try{stManager.done("dist/0bceef6ad055b21676eba8b130f26dc1.924930c66a67f70ac6e0.js")}catch(_){}